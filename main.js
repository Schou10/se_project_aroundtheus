!function(){"use strict";class e{constructor(e){this._baseUrl=e.baseUrl,this._headers=e.headers}_checkResonse(e){return e.ok?e.json():Promise.reject(`Error: ${e.status}`)}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{method:"GET",headers:this._headers}).then(this._checkResonse)}getUserInfo(){return fetch(`${this._baseUrl}/users/me`,{headers:this._headers}).then(this._checkResonse)}updatUserInfo(e){return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e.name,job:e.job})}).then(this._checkResonse)}addNewCard(e){return fetch(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:e.name,link:e.link})}).then(this._checkResonse)}deleteCard(e){return fetch(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers}).then(this._checkResonse)}}new e({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authourization:"Bearer  91b601cc-d5b2-405d-a21a-614e7e8f57e7","Content-Type":"application/json"}});class t{constructor(e,t,s,n){this._name=e.name,this._link=e.link,this._cardSelector=t,this._handleImageClick=s,this._handleDeleteSubmit=n}_getTemplate(){return document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0)}_setEventListeners(){this._likeButton.addEventListener("click",(()=>{this._handleLikeIcon()})),this._deleteButton.addEventListener("click",(()=>{this._handleDeleteSubmit(this)})),this._cardImageElement.addEventListener("click",(()=>{this._handleImageClick({name:this._name,link:this._link})}))}_handleLikeIcon(){this._likeButton.classList.toggle("card__like-button-active")}deleteCard(){this._cardElement.remove(),this._cardElement=null}getView(){return this._cardElement=this._getTemplate(),this._likeButton=this._cardElement.querySelector(".card__like-button"),this._cardImageElement=this._cardElement.querySelector(".card__image"),this._deleteButton=this._cardElement.querySelector(".card__delete-button"),this._cardImageElement.setAttribute("src",this._link),this._cardImageElement.setAttribute("alt",this._name),this._cardElement.querySelector(".card__title").textContent=this._name,this._setEventListeners(),this._cardElement}}class s{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._form=t,this._inputEls=[...this._form.querySelectorAll(this._inputSelector)],this._submitButton=this._form.querySelector(this._submitButtonSelector)}_hideInputError(e){const t=this._form.querySelector(`#${e.id}-error`);e.classList.remove(this._inputErrorClass),t.classList.remove(this._errorClass),t.textContent=""}_showInputError(e){const t=this._form.querySelector(`#${e.id}-error`);e.classList.add(this._inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._errorClass)}_hasInvalidInput(){return this._inputEls.some((e=>!e.validity.valid))}_toggleButtonState(){this._hasInvalidInput()?this.disableButton():this._enableButton()}_enableButton(){this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1}disableButton(){this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}_setEventListeners(){this._toggleButtonState(),this._inputEls.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState()}))})),this._form.addEventListener("reset",(()=>{setTimeout((()=>{this._toggleButtonState()}),0)}))}enableValidation(){this._form.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}}class n{constructor(e,t,s){this._nameElement=document.querySelector(e),this._jobElement=document.querySelector(t),this._avatarElement=document.querySelector(s)}getUserInfo(){return{name:this._nameElement.textContent,job:this._jobElement.textContent,avatar:this._avatarElement.src}}setUserInfo(e){this._nameElement.textContent=e.name,this._jobElement.textContent=e.job,this._avatarElement.textContent=e.avatar}}const r={inputSelector:".modal__input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible"};class o{constructor(e){this._popupElement=document.querySelector(e)}open(){console.log("Opening modal and adding keydown event listener"),this._popupElement.classList.add("modal_opened"),document.addEventListener("keydown",this._handleEscapeClose)}close(){console.log("Closing modal and removing keydown event listener"),this._popupElement.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleEscapeClose)}_handleEscapeClose=e=>{console.log("Escape key pressed"),"Escape"!==e.key&&"Esc"!==e.key||this.close()};setEventListeners(){this._closeButton=this._popupElement.querySelector(".modal__close"),this._closeButton.addEventListener("click",(()=>{this.close()})),this._popupElement.addEventListener("click",(e=>{e.target.classList.contains("modal_opened")&&this.close()}))}}class a extends o{constructor(e,t){super(e),this._popupForm=this._popupElement.querySelector(".modal__form"),this._handleFormSubmit=t,this.inputList=this._popupForm.querySelectorAll(".modal__input")}setEventListeners(){super.setEventListeners(),this._popupForm.addEventListener("submit",(e=>{e.preventDefault();const t=this._getInputValues();this._handleFormSubmit(t),this._popupForm.reset()}))}_getInputValues(){const e={};return this.inputList.forEach((t=>{e[t.name]=t.value.trim()})),e}setInputValues(e){console.log(e),this.inputList.forEach((t=>{t.value=e[t.name]}))}}const i=new e({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"91b601cc-d5b2-405d-a21a-614e7e8f57e7","Content-Type":"application/json"}}),l=new class{constructor(e,t){let{data:s,renderer:n}=e;this._data=s,this._renderer=n,this._container=document.querySelector(t)}renderItems(){this._data.forEach((e=>{this._renderer(e)}))}addItems(e){this._container.prepend(e)}}({data:[{name:"Yosemite Valley",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/yosemite.jpg"},{name:"Lake Louisey",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/lake-louise.jpg"},{name:"Bald Mountains",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/bald-mountains.jpg"},{name:"Latemar",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/latemar.jpg"},{name:"Vanoise National Park",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/vanoise.jpg"},{name:"Lago di Braies",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/lago.jpg"}],renderer:e=>{const t=w(e);l.addItems(t)}},".galary__cards");i.getInitialCards().then((e=>{l.renderItems(e)})).catch((e=>{console.error(e)})),i.getUserInfo().then((e=>{new n("#name","#description","#avatar").getUserInfo(e)})).catch((e=>{console.error(`Error fetching user info: ${e}`)}));const c=new a("#profile-edit-modal",(function(e){userInfo.setUserInfo({name:e.name,job:e.description}),c.close()})),d=new a("#add-card-modal",(function(e){const t=w({name:e.title,link:e.url});l.addItems(t),d.close(),f.reset(),L.disableButton()})),u=new class extends o{constructor(e,t){super(e),this._popupImage=this._popupElement.querySelector(".modal__image"),this._popupTitle=this._popupElement.querySelector(".modal__card-title")}open(e){this._popupImage.src=e.link,this._popupImage.alt=e.name,this._popupTitle.textContent=e.name,super.open()}}("#image-modal",C),h=new a("#delete-modal",B),m=new a("#avatar-modal",(function(e){userInfo.avatarPopup.close()})),_=document.querySelector("#profile-edit-button"),p=document.querySelector("#profile-add-button"),E=document.querySelector("#name-input"),v=document.querySelector("#description-input"),b=(document.querySelector("#avatar-url-input"),document.forms["profile-edit-form"]),f=document.forms["add-card-form"],g=document.forms["delete-form"],k=document.forms["avatar-form"],y=new s(r,b),L=new s(r,f),S=new s(r,g),I=new s(r,k);function w(e){return new t(e,"#card-template",C,B).getView()}function C(e){u.open(e)}function B(e){const t=document.querySelector("#delete-modal"),s=t.querySelector("#delete-confirm-button");t.classList.add("modal_opened"),s.addEventListener("click",(function n(){e.deleteCard(),t.classList.remove("modal_opened"),s.removeEventListener("click",n)}))}y.enableValidation(),L.enableValidation(),S.enableValidation(),I.enableValidation(),_.addEventListener("click",(function(){const e=userInfo.getUserInfo();E.value=e.name,v.value=e.job,c.open()})),p.addEventListener("click",(()=>{d.open()})),c.setEventListeners(),d.setEventListeners(),u.setEventListeners(),h.setEventListeners(),m.setEventListeners()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QjhFLEVBQWtCNUgsaUJBQWlCLFNBUm5DLFdBQ0UsTUFBTTJJLEVBQWM3QixTQUFTM0ksY0FDN0IySixFQUFjeEMsTUFBUXFELEVBQVlsSyxLQUNsQ3NKLEVBQWF6QyxNQUFRcUQsRUFBWWpLLElBQ2pDcUksRUFBVWhELE1BQ1osSUFLQThELEVBQWlCN0gsaUJBQWlCLFNBQVMsS0FDekNpSCxFQUFhbEQsTUFBTSxJQUdyQmdELEVBQVV4QyxvQkFDVjBDLEVBQWExQyxvQkFDYitDLEVBQVcvQyxvQkFDWG1ELEVBQVluRCxvQkFDWm9ELEVBQVlwRCxtQiIsInNvdXJjZXMiOlsid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL0FQSS5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9jYXJkLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvVXNlckluZm8uanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL3V0aWxzL2NvbnN0YW50cy5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9TZWN0aW9uLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBkZWZhdWx0IGNsYXNzIEFwaSB7XHJcbiAgY29uc3RydWN0b3Iob3B0aW9ucykge1xyXG4gICAgdGhpcy5fYmFzZVVybCA9IG9wdGlvbnMuYmFzZVVybDtcclxuICAgIHRoaXMuX2hlYWRlcnMgPSBvcHRpb25zLmhlYWRlcnM7XHJcbiAgfVxyXG5cclxuICBfY2hlY2tSZXNvbnNlKHJlcyl7XHJcbiAgICBpZiAocmVzLm9rKXtcclxuICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgfVxyXG5cclxuICBnZXRJbml0aWFsQ2FyZHMoKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJHRVRcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pXHJcbiAgICAgIC50aGVuKHRoaXMuX2NoZWNrUmVzb25zZSk7XHJcbiAgfVxyXG5cclxuICAvLyBvdGhlciBtZXRob2RzIGZvciB3b3JraW5nIHdpdGggdGhlIEFQSVxyXG4gIGdldFVzZXJJbmZvKCl7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLHtcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVyc1xyXG4gICAgfSlcclxuICAgIC50aGVuKHRoaXMuX2NoZWNrUmVzb25zZSk7XHJcbiAgfVxyXG5cclxuICB1cGRhdFVzZXJJbmZvKGRhdGEpe1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIG5hbWU6IGRhdGEubmFtZSxcclxuICAgICAgICBqb2I6IGRhdGEuam9iXHJcbiAgICAgIH0pXHJcbiAgICB9KVxyXG4gICAgLnRoZW4odGhpcy5fY2hlY2tSZXNvbnNlKTtcclxuICB9XHJcblxyXG4gIGFkZE5ld0NhcmQoZGF0YSkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUE9TVFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgbmFtZTogZGF0YS5uYW1lLFxyXG4gICAgICAgIGxpbms6IGRhdGEubGlua1xyXG4gICAgICB9KVxyXG4gICAgfSlcclxuICAgIC50aGVuKHRoaXMuX2NoZWNrUmVzb25zZSk7XHJcbiAgfVxyXG5cclxuICBkZWxldGVDYXJkKGNhcmRJZCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7Y2FyZElkfWAsIHtcclxuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzXHJcbiAgICB9KVxyXG4gICAgLnRoZW4odGhpcy5fY2hlY2tSZXNvbnNlKTtcclxuICB9XHJcblxyXG4gIH1cclxuXHJcbmNvbnN0IGFwaSA9IG5ldyBBcGkoe1xyXG4gIGJhc2VVcmw6IFwiaHR0cHM6Ly9hcm91bmQtYXBpLmVuLnRyaXBsZXRlbi1zZXJ2aWNlcy5jb20vdjFcIixcclxuICBoZWFkZXJzOiB7XHJcbiAgICBhdXRob3VyaXphdGlvbjogXCJCZWFyZXIgIDkxYjYwMWNjLWQ1YjItNDA1ZC1hMjFhLTYxNGU3ZThmNTdlN1wiLFxyXG4gICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCJcclxuICB9XHJcbn0pOyIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIENhcmQge1xyXG4gIGNvbnN0cnVjdG9yKGRhdGEsIGNhcmRTZWxlY3RvciwgaGFuZGxlSW1hZ2VDbGljaywgaGFuZGxlRGVsZXRlU3VibWl0KSB7XHJcbiAgICB0aGlzLl9uYW1lID0gZGF0YS5uYW1lO1xyXG4gICAgdGhpcy5fbGluayA9IGRhdGEubGluaztcclxuICAgIHRoaXMuX2NhcmRTZWxlY3RvciA9IGNhcmRTZWxlY3RvcjtcclxuICAgIHRoaXMuX2hhbmRsZUltYWdlQ2xpY2sgPSBoYW5kbGVJbWFnZUNsaWNrO1xyXG4gICAgdGhpcy5faGFuZGxlRGVsZXRlU3VibWl0ID0gaGFuZGxlRGVsZXRlU3VibWl0O1xyXG4gIH1cclxuXHJcbiAgX2dldFRlbXBsYXRlKCkge1xyXG4gICAgY29uc3QgY2FyZEVsZW1lbnQgPSBkb2N1bWVudFxyXG4gICAgICAucXVlcnlTZWxlY3Rvcih0aGlzLl9jYXJkU2VsZWN0b3IpXHJcbiAgICAgIC5jb250ZW50XHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKCcuY2FyZCcpXHJcbiAgICAgIC5jbG9uZU5vZGUodHJ1ZSk7XHJcblxyXG4gICAgcmV0dXJuIGNhcmRFbGVtZW50O1xyXG4gIH1cclxuXHJcbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5fbGlrZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuICAgICAgdGhpcy5faGFuZGxlTGlrZUljb24oKTtcclxuICAgIH0pO1xyXG5cclxuICAgIHRoaXMuX2RlbGV0ZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuICAgICAgdGhpcy5faGFuZGxlRGVsZXRlU3VibWl0KHRoaXMpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgdGhpcy5fY2FyZEltYWdlRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuICAgICAgdGhpcy5faGFuZGxlSW1hZ2VDbGljayh7XHJcbiAgICAgICAgbmFtZTogdGhpcy5fbmFtZSxcclxuICAgICAgICBsaW5rOiB0aGlzLl9saW5rLFxyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgX2hhbmRsZUxpa2VJY29uKCkge1xyXG4gICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QudG9nZ2xlKCdjYXJkX19saWtlLWJ1dHRvbi1hY3RpdmUnKTtcclxuICB9XHJcblxyXG4gIGRlbGV0ZUNhcmQoKSB7XHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudC5yZW1vdmUoKTtcclxuICAgIHRoaXMuX2NhcmRFbGVtZW50ID0gbnVsbDtcclxuICB9XHJcblxyXG4gIGdldFZpZXcoKSB7XHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudCA9IHRoaXMuX2dldFRlbXBsYXRlKCk7XHJcbiAgICB0aGlzLl9saWtlQnV0dG9uID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saWtlLWJ1dHRvblwiKVxyXG4gICAgdGhpcy5fY2FyZEltYWdlRWxlbWVudCA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYXJkX19pbWFnZScpO1xyXG4gICAgdGhpcy5fZGVsZXRlQnV0dG9uID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcignLmNhcmRfX2RlbGV0ZS1idXR0b24nKVxyXG5cclxuICAgIHRoaXMuX2NhcmRJbWFnZUVsZW1lbnQuc2V0QXR0cmlidXRlKCdzcmMnLCB0aGlzLl9saW5rKTtcclxuICAgIHRoaXMuX2NhcmRJbWFnZUVsZW1lbnQuc2V0QXR0cmlidXRlKCdhbHQnLCB0aGlzLl9uYW1lKTtcclxuICAgIHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYXJkX190aXRsZScpLnRleHRDb250ZW50ID0gdGhpcy5fbmFtZTtcclxuXHJcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuICAgIHJldHVybiB0aGlzLl9jYXJkRWxlbWVudDtcclxuICB9XHJcbn0iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBGb3JtVmFsaWRhdG9yIHtcclxuICBjb25zdHJ1Y3RvcihzZXR0aW5ncywgZm9ybUVsZW1lbnQpIHtcclxuICAgIHRoaXMuX2lucHV0U2VsZWN0b3IgPSBzZXR0aW5ncy5pbnB1dFNlbGVjdG9yO1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IgPSBzZXR0aW5ncy5zdWJtaXRCdXR0b25TZWxlY3RvcjtcclxuICAgIHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MgPSBzZXR0aW5ncy5pbmFjdGl2ZUJ1dHRvbkNsYXNzO1xyXG4gICAgdGhpcy5faW5wdXRFcnJvckNsYXNzID0gc2V0dGluZ3MuaW5wdXRFcnJvckNsYXNzO1xyXG4gICAgdGhpcy5fZXJyb3JDbGFzcyA9IHNldHRpbmdzLmVycm9yQ2xhc3M7XHJcbiAgICB0aGlzLl9mb3JtID0gZm9ybUVsZW1lbnQ7XHJcbiAgICB0aGlzLl9pbnB1dEVscyA9IFsuLi50aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5faW5wdXRTZWxlY3RvcildO1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yKTtcclxuICB9XHJcblxyXG4gIF9oaWRlSW5wdXRFcnJvcihpbnB1dEVsKSB7XHJcbiAgICBjb25zdCBlcnJvck1lc3NhZ2VFbCA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvcihgIyR7aW5wdXRFbC5pZH0tZXJyb3JgKTtcclxuICAgIGlucHV0RWwuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xyXG4gICAgZXJyb3JNZXNzYWdlRWwuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9lcnJvckNsYXNzKTtcclxuICAgIGVycm9yTWVzc2FnZUVsLnRleHRDb250ZW50ID0gJyc7XHJcbiAgfVxyXG5cclxuICBfc2hvd0lucHV0RXJyb3IoaW5wdXRFbCkge1xyXG4gICAgY29uc3QgZXJyb3JNZXNzYWdlRWwgPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0RWwuaWR9LWVycm9yYCk7XHJcbiAgICBpbnB1dEVsLmNsYXNzTGlzdC5hZGQodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcclxuICAgIGVycm9yTWVzc2FnZUVsLnRleHRDb250ZW50ID0gaW5wdXRFbC52YWxpZGF0aW9uTWVzc2FnZTtcclxuICAgIGVycm9yTWVzc2FnZUVsLmNsYXNzTGlzdC5hZGQodGhpcy5fZXJyb3JDbGFzcyk7XHJcbiAgfVxyXG5cclxuICBfaGFzSW52YWxpZElucHV0KCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX2lucHV0RWxzLnNvbWUoKGlucHV0RWwpID0+ICFpbnB1dEVsLnZhbGlkaXR5LnZhbGlkKTtcclxuICB9XHJcblxyXG4gIF90b2dnbGVCdXR0b25TdGF0ZSgpIHtcclxuICAgIGlmICh0aGlzLl9oYXNJbnZhbGlkSW5wdXQoKSkge1xyXG4gICAgICB0aGlzLmRpc2FibGVCdXR0b24oKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX2VuYWJsZUJ1dHRvbigpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgX2VuYWJsZUJ1dHRvbigpIHtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmRpc2FibGVkID0gZmFsc2U7XHJcbiAgfVxyXG5cclxuICBkaXNhYmxlQnV0dG9uKCkge1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5hZGQodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uZGlzYWJsZWQgPSB0cnVlO1xyXG4gIH1cclxuXHJcbiAgX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsKSB7XHJcbiAgICBpZiAoIWlucHV0RWwudmFsaWRpdHkudmFsaWQpIHtcclxuICAgICAgdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXRFbCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgICB0aGlzLl9pbnB1dEVscy5mb3JFYWNoKChpbnB1dEVsKSA9PiB7XHJcbiAgICAgIGlucHV0RWwuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWwpO1xyXG4gICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgICB0aGlzLl9mb3JtLmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2V0JywgKCkgPT4ge1xyXG4gICAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xyXG4gICAgICB9LCAwKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZW5hYmxlVmFsaWRhdGlvbigpIHtcclxuICAgIHRoaXMuX2Zvcm0uYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgKGUpID0+IHtcclxuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgfSk7XHJcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG4gIH1cclxufSIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFVzZXJJbmZve1xyXG4gIGNvbnN0cnVjdG9yKG5hbWVTZWxjdG9yLCBqb2JTZWxlY3RvciwgYXZhdGFyU2VsZWN0b3Ipe1xyXG4gICAgdGhpcy5fbmFtZUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKG5hbWVTZWxjdG9yKTtcclxuICAgIHRoaXMuX2pvYkVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGpvYlNlbGVjdG9yKTtcclxuICAgIHRoaXMuX2F2YXRhckVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGF2YXRhclNlbGVjdG9yKVxyXG4gICAgXHJcbiAgfVxyXG4gIGdldFVzZXJJbmZvKCl7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBuYW1lOiB0aGlzLl9uYW1lRWxlbWVudC50ZXh0Q29udGVudCwgXHJcbiAgICAgIGpvYjogdGhpcy5fam9iRWxlbWVudC50ZXh0Q29udGVudCxcclxuICAgICAgYXZhdGFyOiB0aGlzLl9hdmF0YXJFbGVtZW50LnNyY307ICAgIFxyXG4gIH1cclxuICBzZXRVc2VySW5mbyhkYXRhKXtcclxuICAgIHRoaXMuX25hbWVFbGVtZW50LnRleHRDb250ZW50ID0gZGF0YS5uYW1lO1xyXG4gICAgdGhpcy5fam9iRWxlbWVudC50ZXh0Q29udGVudCA9IGRhdGEuam9iO1xyXG4gICAgdGhpcy5fYXZhdGFyRWxlbWVudC50ZXh0Q29udGVudCA9IGRhdGEuYXZhdGFyO1xyXG59XHJcbiAgfVxyXG4iLCJleHBvcnQgY29uc3QgaW5pdGlhbENhcmRzID0gW1xyXG4gIHtcclxuICAgIG5hbWU6IFwiWW9zZW1pdGUgVmFsbGV5XCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QveW9zZW1pdGUuanBnXCIgXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIkxha2UgTG91aXNleVwiLFxyXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2xha2UtbG91aXNlLmpwZ1wiIFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJCYWxkIE1vdW50YWluc1wiLFxyXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2JhbGQtbW91bnRhaW5zLmpwZ1wiIFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJMYXRlbWFyXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvbGF0ZW1hci5qcGdcIiBcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiVmFub2lzZSBOYXRpb25hbCBQYXJrXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvdmFub2lzZS5qcGdcIiBcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiTGFnbyBkaSBCcmFpZXNcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYWdvLmpwZ1wiIFxyXG4gIH1cclxuXTtcclxuXHJcbmV4cG9ydCBjb25zdCB2YWxpZGF0aW9uU2V0dGluZ3MgPSB7XHJcbiAgaW5wdXRTZWxlY3RvcjogXCIubW9kYWxfX2lucHV0XCIsXHJcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLm1vZGFsX19idXR0b25cIixcclxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcIm1vZGFsX19idXR0b25fZGlzYWJsZWRcIixcclxuICBpbnB1dEVycm9yQ2xhc3M6IFwibW9kYWxfX2lucHV0X3R5cGVfZXJyb3JcIixcclxuICBlcnJvckNsYXNzOiBcIm1vZGFsX19lcnJvcl92aXNpYmxlXCJcclxufSIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwe1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXBTZWxlY3Rvcik7XHJcbiAgfVxyXG5cclxuICBvcGVuKCkge1xyXG4gICAgY29uc29sZS5sb2coJ09wZW5pbmcgbW9kYWwgYW5kIGFkZGluZyBrZXlkb3duIGV2ZW50IGxpc3RlbmVyJyk7XHJcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnbW9kYWxfb3BlbmVkJyk7XHJcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgdGhpcy5faGFuZGxlRXNjYXBlQ2xvc2UpO1xyXG4gIH1cclxuXHJcbiAgY2xvc2UoKSB7XHJcbiAgICBjb25zb2xlLmxvZygnQ2xvc2luZyBtb2RhbCBhbmQgcmVtb3Zpbmcga2V5ZG93biBldmVudCBsaXN0ZW5lcicpO1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ21vZGFsX29wZW5lZCcpO1xyXG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjYXBlQ2xvc2UpO1xyXG4gIH1cclxuXHJcbiAgX2hhbmRsZUVzY2FwZUNsb3NlID0gKGV2ZW50KSA9PiB7XHJcbiAgICBjb25zb2xlLmxvZygnRXNjYXBlIGtleSBwcmVzc2VkJyk7XHJcbiAgICBpZiAoZXZlbnQua2V5ID09PSBcIkVzY2FwZVwiIHx8IGV2ZW50LmtleSA9PT0gXCJFc2NcIikge1xyXG4gICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX2Nsb3NlQnV0dG9uID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9fY2xvc2UnKTtcclxuICAgIHRoaXMuX2Nsb3NlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge3RoaXMuY2xvc2UoKTt9KTtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChldmVudCkgPT4ge1xyXG4gICAgICBpZiAoZXZlbnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcIm1vZGFsX29wZW5lZFwiKSkge1xyXG4gICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgfVxyXG4gICAgfSApXHJcbiAgfVxyXG59IiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwe1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IsIGhhbmRsZUZvcm1TdWJtaXQpIHtcclxuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5fcG9wdXBGb3JtID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9fZm9ybScpXHJcbiAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0ID0gaGFuZGxlRm9ybVN1Ym1pdDtcclxuICAgIHRoaXMuaW5wdXRMaXN0ID0gdGhpcy5fcG9wdXBGb3JtLnF1ZXJ5U2VsZWN0b3JBbGwoJy5tb2RhbF9faW5wdXQnKTtcclxuICB9XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKVxyXG4gICAgdGhpcy5fcG9wdXBGb3JtLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIChlKSA9PiB7XHJcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgY29uc3QgaW5wdXRWYWx1ZXMgPSB0aGlzLl9nZXRJbnB1dFZhbHVlcygpO1xyXG4gICAgICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQoaW5wdXRWYWx1ZXMpO1xyXG4gICAgICAgIHRoaXMuX3BvcHVwRm9ybS5yZXNldCgpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBfZ2V0SW5wdXRWYWx1ZXMoKSB7XHJcbiAgICBjb25zdCBmb3JtVmFsdWVzID0ge307XHJcbiAgICB0aGlzLmlucHV0TGlzdC5mb3JFYWNoKGlucHV0ID0+IHtcclxuICAgICAgZm9ybVZhbHVlc1tpbnB1dC5uYW1lXSA9IGlucHV0LnZhbHVlLnRyaW0oKTtcclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIGZvcm1WYWx1ZXM7XHJcbiAgfVxyXG4gIHNldElucHV0VmFsdWVzKGRhdGEpIHtcclxuICAgIGNvbnNvbGUubG9nKGRhdGEpO1xyXG4gICAgdGhpcy5pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXQpID0+IHtcclxuICAgICAgLy8gSGVyZSB5b3UgaW5zZXJ0IHRoZSBgdmFsdWVgIGJ5IHRoZSBgbmFtZWAgb2YgdGhlIGlucHV0XHJcbiAgICAgIGlucHV0LnZhbHVlID0gZGF0YVtpbnB1dC5uYW1lXTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbn1cclxuIiwiaW1wb3J0IEFwaSBmcm9tIFwiLi4vY29tcG9uZW50cy9BUEkuanNcIjtcclxuaW1wb3J0IENhcmQgZnJvbSBcIi4uL2NvbXBvbmVudHMvY2FyZC5qc1wiO1xyXG5pbXBvcnQgU2VjdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9TZWN0aW9uLmpzXCI7XHJcbmltcG9ydCBGb3JtVmFsaWRhdG9yIGZyb20gXCIuLi9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanNcIjtcclxuaW1wb3J0IFVzZXJJbmZvICBmcm9tIFwiLi4vY29tcG9uZW50cy9Vc2VySW5mby5qc1wiO1xyXG5pbXBvcnQgeyBpbml0aWFsQ2FyZHMsIHZhbGlkYXRpb25TZXR0aW5ncyB9IGZyb20gXCIuLi91dGlscy9jb25zdGFudHMuanNcIjtcclxuaW1wb3J0IHsgUG9wdXBXaXRoRm9ybSB9IGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanNcIjtcclxuaW1wb3J0IHsgUG9wdXBXaXRoSW1hZ2UgfSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qc1wiO1xyXG5pbXBvcnQgXCIuLi9wYWdlcy9pbmRleC5jc3NcIjtcclxuXHJcbi8vIEFQSVxyXG5jb25zdCBhcGkgPSBuZXcgQXBpKHtcclxuICBiYXNlVXJsOiBcImh0dHBzOi8vYXJvdW5kLWFwaS5lbi50cmlwbGV0ZW4tc2VydmljZXMuY29tL3YxXCIsXHJcbiAgaGVhZGVyczoge1xyXG4gICAgYXV0aG9yaXphdGlvbjogXCI5MWI2MDFjYy1kNWIyLTQwNWQtYTIxYS02MTRlN2U4ZjU3ZTdcIixcclxuICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiXHJcbiAgfVxyXG59KTtcclxuXHJcbi8vIFJlbmRlciBpbml0aWFsIGNhcmRzXHJcbmNvbnN0IHNlY3Rpb24gPSBuZXcgU2VjdGlvbih7XHJcbiAgZGF0YTogaW5pdGlhbENhcmRzLFxyXG4gIHJlbmRlcmVyOiAoY2FyZERhdGEpID0+IHtcclxuICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gY3JlYXRlQ2FyZChjYXJkRGF0YSk7XHJcbiAgICBzZWN0aW9uLmFkZEl0ZW1zKGNhcmRFbGVtZW50KTtcclxuICAgIH1cclxuICB9LCAnLmdhbGFyeV9fY2FyZHMnKTtcclxuICBcclxuXHJcblxyXG5hcGkuZ2V0SW5pdGlhbENhcmRzKClcclxuICAudGhlbihjYXJkcyA9PiB7XHJcbiAgICBzZWN0aW9uLnJlbmRlckl0ZW1zKGNhcmRzKTtcclxuICB9KVxyXG4gIC5jYXRjaChlcnIgPT4ge1xyXG4gICAgY29uc29sZS5lcnJvcihlcnIpO1xyXG4gIH0pXHJcblxyXG4vL0dldCBVc2VyIGluZm9cclxuYXBpLmdldFVzZXJJbmZvKClcclxuLnRoZW4odXNlckluZm8gPT4ge1xyXG4gIGNvbnN0IHVzZXIgPSBuZXcgVXNlckluZm8oXCIjbmFtZVwiLCBcIiNkZXNjcmlwdGlvblwiLCBcIiNhdmF0YXJcIik7XHJcbiAgdXNlci5nZXRVc2VySW5mbyh1c2VySW5mbyk7XHJcbn0pXHJcbi5jYXRjaChlcnIgPT4ge1xyXG4gIGNvbnNvbGUuZXJyb3IoYEVycm9yIGZldGNoaW5nIHVzZXIgaW5mbzogJHtlcnJ9YCk7XHJcbn0pO1xyXG5cclxuXHJcblxyXG4vKiBFbGVtZW50cyAqLyBcclxuXHJcbi8vcG9wdXBzXHJcbmNvbnN0IGVkaXRQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKCcjcHJvZmlsZS1lZGl0LW1vZGFsJywgaGFuZGxlUHJvZmlsZVN1Ym1pdCk7XHJcbmNvbnN0IGFkZGNhcmRQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKCcjYWRkLWNhcmQtbW9kYWwnLCBoYW5kbGVBZGRDYXJkU3VibWl0KTtcclxuY29uc3QgaW1hZ2VQb3B1cCA9IG5ldyBQb3B1cFdpdGhJbWFnZSgnI2ltYWdlLW1vZGFsJywgaGFuZGxlSW1hZ2VDbGljayk7IFxyXG5jb25zdCBkZWxldGVQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKCcjZGVsZXRlLW1vZGFsJywgaGFuZGxlRGVsZXRlU3VibWl0KTtcclxuY29uc3QgYXZhdGFyUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybSgnI2F2YXRhci1tb2RhbCcsIGhhbmRsZUF2YXRhclN1Ym1pdCk7XHJcblxyXG4vL2J1dHRvblxyXG5jb25zdCBwcm9maWxlRWRpdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNwcm9maWxlLWVkaXQtYnV0dG9uJyk7XHJcbmNvbnN0IGFkZE5ld0NhcmRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtYWRkLWJ1dHRvblwiKTtcclxuXHJcbi8vcHJvZmlsZSBuYW1lICYgZGVzY3JpcHRpb24gLyB1c2VyIGluZm8gLyB1c2UgUHJvZmlsZSBpbWdcclxuY29uc3QgdXNlck5hbWVJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjbmFtZS1pbnB1dFwiKTtcclxuY29uc3QgdXNlckpvYklucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNkZXNjcmlwdGlvbi1pbnB1dFwiKTtcclxuY29uc3QgdXNlckF2YXRhcklucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNhdmF0YXItdXJsLWlucHV0XCIpO1xyXG5cclxuXHJcbi8vZm9ybXNcclxuY29uc3QgcHJvZmlsZUVkaXRGb3JtRWxlbWVudCA9IGRvY3VtZW50LmZvcm1zW1wicHJvZmlsZS1lZGl0LWZvcm1cIl07XHJcbmNvbnN0IHByb2ZpbGVBZGRGb3JtRWxlbWVudCA9IGRvY3VtZW50LmZvcm1zW1wiYWRkLWNhcmQtZm9ybVwiXTtcclxuY29uc3QgZGVsZXRlRm9ybUVsZW1lbnQgPSBkb2N1bWVudC5mb3Jtc1tcImRlbGV0ZS1mb3JtXCJdO1xyXG5jb25zdCBhdmF0YXJGb3JtRWxlbWVudCA9IGRvY3VtZW50LmZvcm1zW1wiYXZhdGFyLWZvcm1cIl1cclxuXHJcbi8vdmFsaWRhdG9yc1xyXG5jb25zdCBlZGl0Rm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKHZhbGlkYXRpb25TZXR0aW5ncywgcHJvZmlsZUVkaXRGb3JtRWxlbWVudCk7XHJcbmNvbnN0IGFkZEZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcih2YWxpZGF0aW9uU2V0dGluZ3MsIHByb2ZpbGVBZGRGb3JtRWxlbWVudCk7XHJcbmNvbnN0IGRlbGV0ZUZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcih2YWxpZGF0aW9uU2V0dGluZ3MsIGRlbGV0ZUZvcm1FbGVtZW50KTtcclxuY29uc3QgYXZhdGFyRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKHZhbGlkYXRpb25TZXR0aW5ncywgYXZhdGFyRm9ybUVsZW1lbnQpO1xyXG5cclxuXHJcbi8qIEZ1bmN0aW9ucyovXHJcbi8vRm9ybSBWYWxpZGF0b3JzXHJcbmVkaXRGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuYWRkRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XHJcbmRlbGV0ZUZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG5hdmF0YXJGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuXHJcbi8vQ3JlYXRlIENhcmRcclxuZnVuY3Rpb24gY3JlYXRlQ2FyZChpdGVtKSB7XHJcbiAgY29uc3QgY2FyZEVsZW1lbnQgPSBuZXcgQ2FyZChpdGVtLCAnI2NhcmQtdGVtcGxhdGUnLCBoYW5kbGVJbWFnZUNsaWNrLCBoYW5kbGVEZWxldGVTdWJtaXQpO1xyXG5yZXR1cm4gY2FyZEVsZW1lbnQuZ2V0VmlldygpXHJcbn1cclxuLypFdmVudCBIYW5kbGVycyovXHJcbi8vaW1hZ2UgY2xpY2tcclxuZnVuY3Rpb24gaGFuZGxlSW1hZ2VDbGljayhjYXJkRGF0YSkge1xyXG4gICAgaW1hZ2VQb3B1cC5vcGVuKGNhcmREYXRhKTtcclxufVxyXG5cclxuLy9lZGl0IHByb2ZpbGVcclxuZnVuY3Rpb24gaGFuZGxlUHJvZmlsZVN1Ym1pdChkYXRhKSB7XHJcbiAgdXNlckluZm8uc2V0VXNlckluZm8oe25hbWU6IGRhdGEubmFtZSwgam9iOiBkYXRhLmRlc2NyaXB0aW9ufSk7XHJcbiAgZWRpdFBvcHVwLmNsb3NlKCk7IH1cclxuXHJcblxyXG5cclxuLy9hZGQgY2FyZFxyXG5mdW5jdGlvbiBoYW5kbGVBZGRDYXJkU3VibWl0KGRhdGEpIHtcclxuICBjb25zdCBjYXJkID0ge1xyXG4gICAgbmFtZTogZGF0YS50aXRsZSxcclxuICAgIGxpbms6IGRhdGEudXJsXHJcbiAgfTtcclxuICBjb25zdCBjYXJkRWxlbWVudCA9IGNyZWF0ZUNhcmQoY2FyZCk7XHJcbiAgc2VjdGlvbi5hZGRJdGVtcyhjYXJkRWxlbWVudCk7XHJcbiAgYWRkY2FyZFBvcHVwLmNsb3NlKCk7XHJcbiAgcHJvZmlsZUFkZEZvcm1FbGVtZW50LnJlc2V0KCk7XHJcbiAgYWRkRm9ybVZhbGlkYXRvci5kaXNhYmxlQnV0dG9uKCk7XHJcbn1cclxuLy9hdmF0YXJcclxuZnVuY3Rpb24gaGFuZGxlQXZhdGFyU3VibWl0KGRhdGEpe1xyXG4gIHVzZXJJbmZvLlxyXG4gIGF2YXRhclBvcHVwLmNsb3NlKCk7fVxyXG5cclxuLy9kZWxldGVcclxuZnVuY3Rpb24gaGFuZGxlRGVsZXRlU3VibWl0KGNhcmQpe1xyXG4gIGNvbnN0IGRlbGV0ZU1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2RlbGV0ZS1tb2RhbCcpO1xyXG4gIGNvbnN0IGNvbmZpcm1CdXR0b24gPSBkZWxldGVNb2RhbC5xdWVyeVNlbGVjdG9yKCcjZGVsZXRlLWNvbmZpcm0tYnV0dG9uJyk7XHJcbiAgZGVsZXRlTW9kYWwuY2xhc3NMaXN0LmFkZCgnbW9kYWxfb3BlbmVkJyk7XHJcbiAgY29uZmlybUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uIG9uQ29uZmlybUNsaWNrKCkge1xyXG4gICAgY2FyZC5kZWxldGVDYXJkKCk7XHJcbiAgICBkZWxldGVNb2RhbC5jbGFzc0xpc3QucmVtb3ZlKCdtb2RhbF9vcGVuZWQnKTtcclxuICAgIGNvbmZpcm1CdXR0b24ucmVtb3ZlRXZlbnRMaXN0ZW5lcignY2xpY2snLCBvbkNvbmZpcm1DbGljayk7XHJcbiAgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIG9wZW5FZGl0UHJvZmlsZU1vZGFsKCkge1xyXG4gIGNvbnN0IGN1cnJlbnRVc2VyID0gdXNlckluZm8uZ2V0VXNlckluZm8oKTtcclxuICB1c2VyTmFtZUlucHV0LnZhbHVlID0gY3VycmVudFVzZXIubmFtZTtcclxuICB1c2VySm9iSW5wdXQudmFsdWUgPSBjdXJyZW50VXNlci5qb2I7XHJcbiAgZWRpdFBvcHVwLm9wZW4oKTtcclxufVxyXG5cclxuLy8gRXZlbnQgTGlzdGVuZXJzXHJcbnByb2ZpbGVFZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgb3BlbkVkaXRQcm9maWxlTW9kYWwpO1xyXG5cclxuYWRkTmV3Q2FyZEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuICBhZGRjYXJkUG9wdXAub3BlbigpO1xyXG59KTtcclxuXHJcbmVkaXRQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5hZGRjYXJkUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuaW1hZ2VQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5kZWxldGVQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5hdmF0YXJQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBTZWN0aW9uIHtcclxuICBjb25zdHJ1Y3Rvcih7ZGF0YSwgcmVuZGVyZXJ9LCBjb250YWluZXJTZWxlY3Rvcikge1xyXG4gICAgdGhpcy5fZGF0YSA9IGRhdGE7XHJcbiAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyO1xyXG4gICAgdGhpcy5fY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihjb250YWluZXJTZWxlY3Rvcik7XHJcbiAgfVxyXG5cclxuICByZW5kZXJJdGVtcygpIHtcclxuICAgIHRoaXMuX2RhdGEuZm9yRWFjaChpdGVtID0+IHtcclxuICAgICAgdGhpcy5fcmVuZGVyZXIoaXRlbSk7XHJcbiAgfSk7XHJcbn1cclxuXHJcbiAgYWRkSXRlbXMoZWxlbWVudCkge1xyXG4gICAgdGhpcy5fY29udGFpbmVyLnByZXBlbmQoZWxlbWVudCk7XHJcbiAgfVxyXG59IiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yLCBkYXRhKSB7XHJcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcclxuICAgIHRoaXMuX3BvcHVwSW1hZ2UgPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsX19pbWFnZScpO1xyXG4gICAgdGhpcy5fcG9wdXBUaXRsZSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfX2NhcmQtdGl0bGUnKTtcclxuICAgIFxyXG4gICAgXHJcblxyXG4gIH1cclxuICBvcGVuKGRhdGEpe1xyXG4gICAvLyBzZXQgdGhlIGltYWdlJ3Mgc3JjIGFuZCBhbHRcclxuICAgIHRoaXMuX3BvcHVwSW1hZ2Uuc3JjID0gZGF0YS5saW5rO1xyXG4gICAgdGhpcy5fcG9wdXBJbWFnZS5hbHQgPSBkYXRhLm5hbWU7XHJcbiAgIC8vIHNldCB0aGUgY2FwdGlvbidzIHRleHRDb250ZW50XHJcbiAgICB0aGlzLl9wb3B1cFRpdGxlLnRleHRDb250ZW50ID0gZGF0YS5uYW1lO1xyXG4gICAgc3VwZXIub3BlbigpO1xyXG4gIH1cclxufSJdLCJuYW1lcyI6WyJBcGkiLCJjb25zdHJ1Y3RvciIsIm9wdGlvbnMiLCJ0aGlzIiwiX2Jhc2VVcmwiLCJiYXNlVXJsIiwiX2hlYWRlcnMiLCJoZWFkZXJzIiwiX2NoZWNrUmVzb25zZSIsInJlcyIsIm9rIiwianNvbiIsIlByb21pc2UiLCJyZWplY3QiLCJzdGF0dXMiLCJnZXRJbml0aWFsQ2FyZHMiLCJmZXRjaCIsIm1ldGhvZCIsInRoZW4iLCJnZXRVc2VySW5mbyIsInVwZGF0VXNlckluZm8iLCJkYXRhIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJuYW1lIiwiam9iIiwiYWRkTmV3Q2FyZCIsImxpbmsiLCJkZWxldGVDYXJkIiwiY2FyZElkIiwiYXV0aG91cml6YXRpb24iLCJDYXJkIiwiY2FyZFNlbGVjdG9yIiwiaGFuZGxlSW1hZ2VDbGljayIsImhhbmRsZURlbGV0ZVN1Ym1pdCIsIl9uYW1lIiwiX2xpbmsiLCJfY2FyZFNlbGVjdG9yIiwiX2hhbmRsZUltYWdlQ2xpY2siLCJfaGFuZGxlRGVsZXRlU3VibWl0IiwiX2dldFRlbXBsYXRlIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiY29udGVudCIsImNsb25lTm9kZSIsIl9zZXRFdmVudExpc3RlbmVycyIsIl9saWtlQnV0dG9uIiwiYWRkRXZlbnRMaXN0ZW5lciIsIl9oYW5kbGVMaWtlSWNvbiIsIl9kZWxldGVCdXR0b24iLCJfY2FyZEltYWdlRWxlbWVudCIsImNsYXNzTGlzdCIsInRvZ2dsZSIsIl9jYXJkRWxlbWVudCIsInJlbW92ZSIsImdldFZpZXciLCJzZXRBdHRyaWJ1dGUiLCJ0ZXh0Q29udGVudCIsIkZvcm1WYWxpZGF0b3IiLCJzZXR0aW5ncyIsImZvcm1FbGVtZW50IiwiX2lucHV0U2VsZWN0b3IiLCJpbnB1dFNlbGVjdG9yIiwiX3N1Ym1pdEJ1dHRvblNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJfaW5hY3RpdmVCdXR0b25DbGFzcyIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJfaW5wdXRFcnJvckNsYXNzIiwiaW5wdXRFcnJvckNsYXNzIiwiX2Vycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwiX2Zvcm0iLCJfaW5wdXRFbHMiLCJxdWVyeVNlbGVjdG9yQWxsIiwiX3N1Ym1pdEJ1dHRvbiIsIl9oaWRlSW5wdXRFcnJvciIsImlucHV0RWwiLCJlcnJvck1lc3NhZ2VFbCIsImlkIiwiX3Nob3dJbnB1dEVycm9yIiwiYWRkIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJfaGFzSW52YWxpZElucHV0Iiwic29tZSIsInZhbGlkaXR5IiwidmFsaWQiLCJfdG9nZ2xlQnV0dG9uU3RhdGUiLCJkaXNhYmxlQnV0dG9uIiwiX2VuYWJsZUJ1dHRvbiIsImRpc2FibGVkIiwiX2NoZWNrSW5wdXRWYWxpZGl0eSIsImZvckVhY2giLCJzZXRUaW1lb3V0IiwiZW5hYmxlVmFsaWRhdGlvbiIsImUiLCJwcmV2ZW50RGVmYXVsdCIsIlVzZXJJbmZvIiwibmFtZVNlbGN0b3IiLCJqb2JTZWxlY3RvciIsImF2YXRhclNlbGVjdG9yIiwiX25hbWVFbGVtZW50IiwiX2pvYkVsZW1lbnQiLCJfYXZhdGFyRWxlbWVudCIsImF2YXRhciIsInNyYyIsInNldFVzZXJJbmZvIiwidmFsaWRhdGlvblNldHRpbmdzIiwiUG9wdXAiLCJwb3B1cFNlbGVjdG9yIiwiX3BvcHVwRWxlbWVudCIsIm9wZW4iLCJjb25zb2xlIiwibG9nIiwiX2hhbmRsZUVzY2FwZUNsb3NlIiwiY2xvc2UiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiZXZlbnQiLCJrZXkiLCJzZXRFdmVudExpc3RlbmVycyIsIl9jbG9zZUJ1dHRvbiIsInRhcmdldCIsImNvbnRhaW5zIiwiUG9wdXBXaXRoRm9ybSIsImhhbmRsZUZvcm1TdWJtaXQiLCJzdXBlciIsIl9wb3B1cEZvcm0iLCJfaGFuZGxlRm9ybVN1Ym1pdCIsImlucHV0TGlzdCIsImlucHV0VmFsdWVzIiwiX2dldElucHV0VmFsdWVzIiwicmVzZXQiLCJmb3JtVmFsdWVzIiwiaW5wdXQiLCJ2YWx1ZSIsInRyaW0iLCJzZXRJbnB1dFZhbHVlcyIsImFwaSIsImF1dGhvcml6YXRpb24iLCJzZWN0aW9uIiwiX3JlZiIsImNvbnRhaW5lclNlbGVjdG9yIiwicmVuZGVyZXIiLCJfZGF0YSIsIl9yZW5kZXJlciIsIl9jb250YWluZXIiLCJyZW5kZXJJdGVtcyIsIml0ZW0iLCJhZGRJdGVtcyIsImVsZW1lbnQiLCJwcmVwZW5kIiwiY2FyZERhdGEiLCJjYXJkRWxlbWVudCIsImNyZWF0ZUNhcmQiLCJjYXJkcyIsImNhdGNoIiwiZXJyIiwiZXJyb3IiLCJ1c2VySW5mbyIsImVkaXRQb3B1cCIsImRlc2NyaXB0aW9uIiwiYWRkY2FyZFBvcHVwIiwidGl0bGUiLCJ1cmwiLCJwcm9maWxlQWRkRm9ybUVsZW1lbnQiLCJhZGRGb3JtVmFsaWRhdG9yIiwiaW1hZ2VQb3B1cCIsIl9wb3B1cEltYWdlIiwiX3BvcHVwVGl0bGUiLCJhbHQiLCJkZWxldGVQb3B1cCIsImF2YXRhclBvcHVwIiwicHJvZmlsZUVkaXRCdXR0b24iLCJhZGROZXdDYXJkQnV0dG9uIiwidXNlck5hbWVJbnB1dCIsInVzZXJKb2JJbnB1dCIsInByb2ZpbGVFZGl0Rm9ybUVsZW1lbnQiLCJmb3JtcyIsImRlbGV0ZUZvcm1FbGVtZW50IiwiYXZhdGFyRm9ybUVsZW1lbnQiLCJlZGl0Rm9ybVZhbGlkYXRvciIsImRlbGV0ZUZvcm1WYWxpZGF0b3IiLCJhdmF0YXJGb3JtVmFsaWRhdG9yIiwiY2FyZCIsImRlbGV0ZU1vZGFsIiwiY29uZmlybUJ1dHRvbiIsIm9uQ29uZmlybUNsaWNrIiwiY3VycmVudFVzZXIiXSwic291cmNlUm9vdCI6IiJ9