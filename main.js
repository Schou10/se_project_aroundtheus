!function(){"use strict";class e{constructor(e){this._baseUrl=e.baseUrl,this._headers=e.headers}_checkResponse(e){return e.ok?e.json():Promise.reject(`Error: ${e.status}`)}_request(e,t){return fetch(e,t).then(this._checkResponse)}getInitialCards(){return this._request(`${this._baseUrl}/cards`,{method:"GET",headers:this._headers})}getUserInfo(){return this._request(`${this._baseUrl}/users/me`,{method:"GET",headers:this._headers})}updateUserInfo(e){return this._request(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify(e)})}updateUserAvatar(e){return this._request(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e.avatar})})}addNewCard(e){return this._request(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:e.name,link:e.link})})}deleteCard(e){return this._request(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers})}addLike(e){return this._request(`${this._baseUrl}/cards/${e}/likes`,{method:"PUT",headers:this._headers})}removeLike(e){return this._request(`${this._baseUrl}/cards/${e}/likes`,{method:"DELETE",headers:this._headers})}}new e({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authourization:"Bearer  91b601cc-d5b2-405d-a21a-614e7e8f57e7","Content-Type":"application/json"}});class t{constructor(e,t,s,r,n){this._id=e._id,this._name=e.name,this._link=e.link,this._isLiked=e.isLiked,this._userId=e.owner,this._cardSelector=t,this._handleImageClick=s,this._handleDeleteSubmit=r,this._handleCardLike=n,this._element=this._getTemplate()}_getTemplate(){return document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0)}_setEventListeners(){this._likeButton.addEventListener("click",(()=>{this._handleCardLike(this)})),this._deleteButton.addEventListener("click",(()=>{this._handleDeleteSubmit(this)})),this._cardImageElement.addEventListener("click",(()=>{this._handleImageClick({name:this._name,link:this._link})}))}isLiked(){return this._isLiked}updateLikes(e){this._isLiked=e,this.toggleLikeIcon()}toggleLikeIcon(){this._likeButton.classList.toggle("card__like-button-active",this._isLiked)}getId(){return this._id}removeCard(){this._cardElement.remove(),this._cardElement=null}getView(){return this._cardElement=this._getTemplate(),this._likeButton=this._cardElement.querySelector(".card__like-button"),this._cardImageElement=this._cardElement.querySelector(".card__image"),this._deleteButton=this._cardElement.querySelector(".card__delete-button"),this._cardImageElement.setAttribute("src",this._link),this._cardImageElement.setAttribute("alt",this._name),this._cardElement.querySelector(".card__title").textContent=this._name,this.toggleLikeIcon(),this._setEventListeners(),this._cardElement}}class s{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._form=t,this._inputEls=[...this._form.querySelectorAll(this._inputSelector)],this._submitButton=this._form.querySelector(this._submitButtonSelector)}_hideInputError(e){const t=this._form.querySelector(`#${e.id}-error`);e.classList.remove(this._inputErrorClass),t.classList.remove(this._errorClass),t.textContent=""}_showInputError(e){const t=this._form.querySelector(`#${e.id}-error`);e.classList.add(this._inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._errorClass)}_hasInvalidInput(){return this._inputEls.some((e=>!e.validity.valid))}_toggleButtonState(){this._hasInvalidInput()?this.disableButton():this._enableButton()}_enableButton(){this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1}disableButton(){this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}_setEventListeners(){this._toggleButtonState(),this._inputEls.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState()}))})),this._form.addEventListener("reset",(()=>{setTimeout((()=>{this._toggleButtonState()}),0)}))}enableValidation(){this._form.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}}const r={inputSelector:".modal__input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible"};class n{constructor(e){this._popupElement=document.querySelector(e)}open(){this._popupElement.classList.add("modal_opened"),document.addEventListener("keydown",this._handleEscapeClose)}close(){this._popupElement.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleEscapeClose)}_handleEscapeClose=e=>{"Escape"!==e.key&&"Esc"!==e.key||this.close()};setEventListeners(){this._closeButton=this._popupElement.querySelector(".modal__close"),this._closeButton.addEventListener("click",(()=>{this.close()})),this._popupElement.addEventListener("click",(e=>{e.target.classList.contains("modal_opened")&&this.close()}))}}class i extends n{constructor(e,t){super(e),this._popupForm=this._popupElement.querySelector(".modal__form"),this._handleFormSubmit=t,this.inputList=this._popupForm.querySelectorAll(".modal__input"),this.submitButton=this._popupForm.querySelector(".modal__button")}setEventListeners(){super.setEventListeners(),this._popupForm.addEventListener("submit",(e=>{e.preventDefault();const t=this._getInputValues();this._handleFormSubmit(t)}))}_getInputValues(){const e={};return this.inputList.forEach((t=>{e[t.name]=t.value.trim()})),e}setInputValues(e){console.log(e),this.inputList.forEach((t=>{t.value=e[t.name]}))}}const a=new e({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"91b601cc-d5b2-405d-a21a-614e7e8f57e7","Content-Type":"application/json"}}),o=new class{constructor(e,t){let{data:s,renderer:r}=e;this._data=s,this._renderer=r,this._container=document.querySelector(t)}renderItems(e){e.forEach((e=>{this._renderer(e)}))}addItems(e){this._container.prepend(e)}}({renderer:e=>{const t=B(e);o.addItems(t)}},".galary__cards"),l=new class{constructor(e,t,s){this._nameElement=document.querySelector(e),this._jobElement=document.querySelector(t),this._avatarElement=document.querySelector(s)}getUserInfo(){return{name:this._nameElement.textContent,about:this._jobElement.textContent,avatar:this._avatarElement.src}}setUserInfo(e){e.name&&(this._nameElement.textContent=e.name),e.about&&(this._jobElement.textContent=e.about),e.avatar&&(this._avatarElement.src=e.avatar)}}("#name","#description","#avatar");a.getUserInfo().then((e=>{l.setUserInfo({name:e.name,about:e.about,avatar:e.avatar})})).catch((e=>{console.error(`Error fetching user info: ${e}`)})),a.getInitialCards().then((e=>{o.renderItems(e)})).catch((e=>{console.error(`Error fetcting cards: ${e}`)}));const d=new i("#profile-edit-modal",(function(e){x(!0,d),a.updateUserInfo({name:e.name,about:e.about}).then((e=>{l.setUserInfo({name:e.name,about:e.about||e.dascription||e.bio})})).catch((e=>console.error(`Error updating profile: ${e}`))).finally((()=>{x(!1,d),d.close()}))})),u=new i("#add-card-modal",(function(e){const t={name:e.title,link:e.url};x(!0,u),a.addNewCard(t).then((e=>{const t=B(e);o.addItems(t),u.close(),g.reset(),S.disableButton()})).catch((e=>{console.error(`Error adding card: ${e}`)})).finally((()=>{x(!1,u)}))})),c=new class extends n{constructor(e,t){super(e),this._popupImage=this._popupElement.querySelector(".modal__image"),this._popupTitle=this._popupElement.querySelector(".modal__card-title")}open(e){this._popupImage.src=e.link,this._popupImage.alt=e.name,this._popupTitle.textContent=e.name,super.open()}}("#image-modal",q),h=new class extends n{constructor(e){super(e),this.confirmButton=this._popupElement.querySelector(".modal__button")}setSubmitFunction(e){this._handleConfirm=e}setEventListeners(){super.setEventListeners()}}("#delete-modal"),_=new i("#avatar-modal",(function(e){x(!0,_),a.updateUserAvatar({avatar:e.url}).then((e=>{l.setUserInfo({avatar:e.avatar})})).catch((e=>console.error(`Error updating avatar: ${e}`))).finally((()=>{x(!1,_),_.close(),k.reset()}))})),m=document.querySelector("#profile-edit-button"),p=document.querySelector("#profile-add-button"),E=document.querySelector("#avatar-overlay"),v=document.querySelector("#name-input"),b=document.querySelector("#description-input"),f=document.forms["profile-edit-form"],g=document.forms["add-card-form"],L=document.forms["delete-form"],k=document.forms["avatar-form"],C=new s(r,f),S=new s(r,g),y=new s(r,L),I=new s(r,k);function B(e){return new t(e,"#card-template",q,U,w).getView()}function q(e){c.open(e)}function U(e){x(!0,h),h.setSubmitFunction((()=>{a.deleteCard(e._id).then((e=>{console.log(e)})).catch((e=>{console.error(`Error deleting card ${e}`)})).finally((()=>{x(!1,h),h.close(),e.removeCard()}))})),h.open()}function w(e){(e.isLiked()?a.removeLike(e.getId()):a.addLike(e.getId())).then((t=>{e.updateLikes(t.isLiked)})).catch((e=>console.error(`Error updating like status: ${e}`)))}function $(e){const t=l.getUserInfo();v.value=t.name,b.value=t.about,e.open()}function x(e,t){if(e){if(t==h)return t.confirmButton.textContent="Deleating Card";if(t==u)return t.submitButton.textContent="Creating Card";if(t==d||_)return t.submitButton.textContent="Saving"}else{if(t==h)return t.confirmButton.textContent="Yes";if(t==u)return t.submitButton.textContent="Create";if(t==d||_)return t.submitButton.textContent="Save"}}C.enableValidation(),S.enableValidation(),y.enableValidation(),I.enableValidation(),E.addEventListener("click",(()=>{$(_)})),m.addEventListener("click",(()=>{$(d)})),p.addEventListener("click",(()=>{u.open()})),d.setEventListeners(),u.setEventListeners(),c.setEventListeners(),h.setEventListeners(),_.setEventListeners()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUNWLE9BQU9xQixFQUFNcEIsY0FBY3RILFlBQWMsTUFFM0MsR0FBRzBJLEdBQVMvQixFQUNWLE9BQU8rQixFQUFNL0UsYUFBYTNELFlBQWMsU0FFMUMsR0FBRzBJLEdBQVNyQyxHQUFhcUIsRUFDdkIsT0FBT2dCLEVBQU0vRSxhQUFhM0QsWUFBYyxNQUU5QyxDQUFDLENBN0pEb0ksRUFBa0JoRyxtQkFDbEI0RSxFQUFpQjVFLG1CQUNqQmlHLEVBQW9CakcsbUJBQ3BCa0csRUFBb0JsRyxtQkE2SnBCbkYsRUFBT2lDLGlCQUFpQixTQUFTLEtBQU11SixFQUFVZixFQUFZLElBRTdERyxFQUFrQjNJLGlCQUFpQixTQUFTLEtBQU11SixFQUFVcEMsRUFBVSxJQUV0RXlCLEVBQWlCNUksaUJBQWlCLFNBQVMsS0FDekN5SCxFQUFhaEUsTUFBTSxJQUtyQjBELEVBQVVwRCxvQkFDVjBELEVBQWExRCxvQkFDYmdFLEVBQVdoRSxvQkFDWG9FLEVBQVlwRSxvQkFDWnlFLEVBQVl6RSxtQiIsInNvdXJjZXMiOlsid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL0FQSS5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9jYXJkLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL3V0aWxzL2NvbnN0YW50cy5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9TZWN0aW9uLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aENvbmZpcm1hdGlvbi5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZGVmYXVsdCBjbGFzcyBBcGkge1xyXG4gIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHtcclxuICAgIHRoaXMuX2Jhc2VVcmwgPSBvcHRpb25zLmJhc2VVcmw7XHJcbiAgICB0aGlzLl9oZWFkZXJzID0gb3B0aW9ucy5oZWFkZXJzO1xyXG4gIH1cclxuXHJcbiAgX2NoZWNrUmVzcG9uc2UocmVzKXtcclxuICAgIGlmIChyZXMub2spe1xyXG4gICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgIH1cclxuICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcclxuICB9XHJcblxyXG4gIF9yZXF1ZXN0KHVybCwgb3B0aW9ucyl7XHJcbiAgICByZXR1cm4gZmV0Y2godXJsLCBvcHRpb25zKS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xyXG4gIH1cclxuXHJcbiAgZ2V0SW5pdGlhbENhcmRzKCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJHRVRcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLy8gb3RoZXIgbWV0aG9kcyBmb3Igd29ya2luZyB3aXRoIHRoZSBBUElcclxuICBnZXRVc2VySW5mbygpe1xyXG4gICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLHtcclxuICAgICAgbWV0aG9kIDpcIkdFVFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIHVwZGF0ZVVzZXJJbmZvKGRhdGEpe1xyXG4gICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeShkYXRhKVxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICB1cGRhdGVVc2VyQXZhdGFyKGRhdGEpe1xyXG4gICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWUvYXZhdGFyYCx7XHJcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgYXZhdGFyOiBkYXRhLmF2YXRhclxyXG4gICAgICB9KVxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBhZGROZXdDYXJkKGRhdGEpIHtcclxuICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0KGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUE9TVFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgbmFtZTogZGF0YS5uYW1lLFxyXG4gICAgICAgIGxpbms6IGRhdGEubGlua1xyXG4gICAgICB9KVxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBkZWxldGVDYXJkKGNhcmRJZCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtjYXJkSWR9YCwge1xyXG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnNcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgYWRkTGlrZShjYXJkSWQpe1xyXG4gICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtjYXJkSWR9L2xpa2VzYCwge1xyXG4gICAgICBtZXRob2Q6ICdQVVQnLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIHJlbW92ZUxpa2UoY2FyZElkKXtcclxuICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0KGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7Y2FyZElkfS9saWtlc2AsIHtcclxuICAgICAgbWV0aG9kOiAnREVMRVRFJyxcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVyc1xyXG4gICAgfSlcclxuICB9XHJcblxyXG4gIH1cclxuXHJcbmNvbnN0IGFwaSA9IG5ldyBBcGkoe1xyXG4gIGJhc2VVcmw6IFwiaHR0cHM6Ly9hcm91bmQtYXBpLmVuLnRyaXBsZXRlbi1zZXJ2aWNlcy5jb20vdjFcIixcclxuICBoZWFkZXJzOiB7XHJcbiAgICBhdXRob3VyaXphdGlvbjogXCJCZWFyZXIgIDkxYjYwMWNjLWQ1YjItNDA1ZC1hMjFhLTYxNGU3ZThmNTdlN1wiLFxyXG4gICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCJcclxuICB9XHJcbn0pOyIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIENhcmQge1xyXG4gIGNvbnN0cnVjdG9yKGRhdGEsIGNhcmRTZWxlY3RvciwgaGFuZGxlSW1hZ2VDbGljaywgaGFuZGxlRGVsZXRlU3VibWl0LCBoYW5kbGVDYXJkTGlrZSkge1xyXG4gICAgdGhpcy5faWQgPSBkYXRhLl9pZDtcclxuICAgIHRoaXMuX25hbWUgPSBkYXRhLm5hbWU7XHJcbiAgICB0aGlzLl9saW5rID0gZGF0YS5saW5rO1xyXG4gICAgdGhpcy5faXNMaWtlZCA9IGRhdGEuaXNMaWtlZDtcclxuICAgIHRoaXMuX3VzZXJJZCA9IGRhdGEub3duZXI7XHJcbiAgICB0aGlzLl9jYXJkU2VsZWN0b3IgPSBjYXJkU2VsZWN0b3I7XHJcbiAgICB0aGlzLl9oYW5kbGVJbWFnZUNsaWNrID0gaGFuZGxlSW1hZ2VDbGljaztcclxuICAgIHRoaXMuX2hhbmRsZURlbGV0ZVN1Ym1pdCA9IGhhbmRsZURlbGV0ZVN1Ym1pdDtcclxuICAgIHRoaXMuX2hhbmRsZUNhcmRMaWtlID0gaGFuZGxlQ2FyZExpa2U7XHJcbiAgICB0aGlzLl9lbGVtZW50ID0gdGhpcy5fZ2V0VGVtcGxhdGUoKTtcclxuICB9XHJcblxyXG4gIF9nZXRUZW1wbGF0ZSgpIHtcclxuICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gZG9jdW1lbnRcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IodGhpcy5fY2FyZFNlbGVjdG9yKVxyXG4gICAgICAuY29udGVudFxyXG4gICAgICAucXVlcnlTZWxlY3RvcignLmNhcmQnKVxyXG4gICAgICAuY2xvbmVOb2RlKHRydWUpO1xyXG4gICAgcmV0dXJuIGNhcmRFbGVtZW50O1xyXG4gIH1cclxuXHJcbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5fbGlrZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuICAgICAgdGhpcy5faGFuZGxlQ2FyZExpa2UodGhpcyk7XHJcbiAgICB9KTtcclxuXHJcbiAgICB0aGlzLl9kZWxldGVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XHJcbiAgICAgIHRoaXMuX2hhbmRsZURlbGV0ZVN1Ym1pdCh0aGlzKTtcclxuICAgIH0pO1xyXG5cclxuICAgIHRoaXMuX2NhcmRJbWFnZUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XHJcbiAgICAgIHRoaXMuX2hhbmRsZUltYWdlQ2xpY2soe1xyXG4gICAgICAgIG5hbWU6IHRoaXMuX25hbWUsXHJcbiAgICAgICAgbGluazogdGhpcy5fbGluayxcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGlzTGlrZWQoKXtcclxuICAgIHJldHVybiB0aGlzLl9pc0xpa2VkO1xyXG4gIH1cclxuXHJcbiAgdXBkYXRlTGlrZXModXBkYXRlZExpa2UpIHsgXHJcbiAgICB0aGlzLl9pc0xpa2VkID0gdXBkYXRlZExpa2U7IC8vdXBkYXRlcyBpc0xpa2VkIEJvb2xlYW5cclxuICAgIHRoaXMudG9nZ2xlTGlrZUljb24oKTtcclxuICB9XHJcblxyXG4gIHRvZ2dsZUxpa2VJY29uKCkge1xyXG4gICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QudG9nZ2xlKCdjYXJkX19saWtlLWJ1dHRvbi1hY3RpdmUnLCB0aGlzLl9pc0xpa2VkKTtcclxuICAgIFxyXG4gIH1cclxuXHJcbiAgZ2V0SWQoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5faWQ7XHJcbiAgfVxyXG5cclxuICByZW1vdmVDYXJkKCkge1xyXG4gICAgdGhpcy5fY2FyZEVsZW1lbnQucmVtb3ZlKCk7XHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudCA9IG51bGw7XHJcbiAgfVxyXG5cclxuICBnZXRWaWV3KCkge1xyXG4gICAgdGhpcy5fY2FyZEVsZW1lbnQgPSB0aGlzLl9nZXRUZW1wbGF0ZSgpO1xyXG4gICAgdGhpcy5fbGlrZUJ1dHRvbiA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbGlrZS1idXR0b25cIilcclxuICAgIHRoaXMuX2NhcmRJbWFnZUVsZW1lbnQgPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuY2FyZF9faW1hZ2UnKTtcclxuICAgIHRoaXMuX2RlbGV0ZUJ1dHRvbiA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYXJkX19kZWxldGUtYnV0dG9uJylcclxuICAgIHRoaXMuX2NhcmRJbWFnZUVsZW1lbnQuc2V0QXR0cmlidXRlKCdzcmMnLCB0aGlzLl9saW5rKTtcclxuICAgIHRoaXMuX2NhcmRJbWFnZUVsZW1lbnQuc2V0QXR0cmlidXRlKCdhbHQnLCB0aGlzLl9uYW1lKTtcclxuICAgIHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYXJkX190aXRsZScpLnRleHRDb250ZW50ID0gdGhpcy5fbmFtZTtcclxuICAgIHRoaXMudG9nZ2xlTGlrZUljb24oKTsgLy9TaG93cyB0aGUgdXNlciBpZiBpdCBhbHJlYWR5IGxpa2VkXHJcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuICAgIHJldHVybiB0aGlzLl9jYXJkRWxlbWVudDtcclxuICB9XHJcbn0iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBGb3JtVmFsaWRhdG9yIHtcclxuICBjb25zdHJ1Y3RvcihzZXR0aW5ncywgZm9ybUVsZW1lbnQpIHtcclxuICAgIHRoaXMuX2lucHV0U2VsZWN0b3IgPSBzZXR0aW5ncy5pbnB1dFNlbGVjdG9yO1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IgPSBzZXR0aW5ncy5zdWJtaXRCdXR0b25TZWxlY3RvcjtcclxuICAgIHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MgPSBzZXR0aW5ncy5pbmFjdGl2ZUJ1dHRvbkNsYXNzO1xyXG4gICAgdGhpcy5faW5wdXRFcnJvckNsYXNzID0gc2V0dGluZ3MuaW5wdXRFcnJvckNsYXNzO1xyXG4gICAgdGhpcy5fZXJyb3JDbGFzcyA9IHNldHRpbmdzLmVycm9yQ2xhc3M7XHJcbiAgICB0aGlzLl9mb3JtID0gZm9ybUVsZW1lbnQ7XHJcbiAgICB0aGlzLl9pbnB1dEVscyA9IFsuLi50aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5faW5wdXRTZWxlY3RvcildO1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yKTtcclxuICB9XHJcblxyXG4gIF9oaWRlSW5wdXRFcnJvcihpbnB1dEVsKSB7XHJcbiAgICBjb25zdCBlcnJvck1lc3NhZ2VFbCA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvcihgIyR7aW5wdXRFbC5pZH0tZXJyb3JgKTtcclxuICAgIGlucHV0RWwuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xyXG4gICAgZXJyb3JNZXNzYWdlRWwuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9lcnJvckNsYXNzKTtcclxuICAgIGVycm9yTWVzc2FnZUVsLnRleHRDb250ZW50ID0gJyc7XHJcbiAgfVxyXG5cclxuICBfc2hvd0lucHV0RXJyb3IoaW5wdXRFbCkge1xyXG4gICAgY29uc3QgZXJyb3JNZXNzYWdlRWwgPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0RWwuaWR9LWVycm9yYCk7XHJcbiAgICBpbnB1dEVsLmNsYXNzTGlzdC5hZGQodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcclxuICAgIGVycm9yTWVzc2FnZUVsLnRleHRDb250ZW50ID0gaW5wdXRFbC52YWxpZGF0aW9uTWVzc2FnZTtcclxuICAgIGVycm9yTWVzc2FnZUVsLmNsYXNzTGlzdC5hZGQodGhpcy5fZXJyb3JDbGFzcyk7XHJcbiAgfVxyXG5cclxuICBfaGFzSW52YWxpZElucHV0KCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX2lucHV0RWxzLnNvbWUoKGlucHV0RWwpID0+ICFpbnB1dEVsLnZhbGlkaXR5LnZhbGlkKTtcclxuICB9XHJcblxyXG4gIF90b2dnbGVCdXR0b25TdGF0ZSgpIHtcclxuICAgIGlmICh0aGlzLl9oYXNJbnZhbGlkSW5wdXQoKSkge1xyXG4gICAgICB0aGlzLmRpc2FibGVCdXR0b24oKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX2VuYWJsZUJ1dHRvbigpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgX2VuYWJsZUJ1dHRvbigpIHtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmRpc2FibGVkID0gZmFsc2U7XHJcbiAgfVxyXG5cclxuICBkaXNhYmxlQnV0dG9uKCkge1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5hZGQodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uZGlzYWJsZWQgPSB0cnVlO1xyXG4gIH1cclxuXHJcbiAgX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsKSB7XHJcbiAgICBpZiAoIWlucHV0RWwudmFsaWRpdHkudmFsaWQpIHtcclxuICAgICAgdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXRFbCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgICB0aGlzLl9pbnB1dEVscy5mb3JFYWNoKChpbnB1dEVsKSA9PiB7XHJcbiAgICAgIGlucHV0RWwuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWwpO1xyXG4gICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgICB0aGlzLl9mb3JtLmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2V0JywgKCkgPT4ge1xyXG4gICAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xyXG4gICAgICB9LCAwKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZW5hYmxlVmFsaWRhdGlvbigpIHtcclxuICAgIHRoaXMuX2Zvcm0uYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgKGUpID0+IHtcclxuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgfSk7XHJcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG4gIH1cclxufSIsImV4cG9ydCBjb25zdCBpbml0aWFsQ2FyZHMgPSBbXHJcbiAge1xyXG4gICAgbmFtZTogXCJZb3NlbWl0ZSBWYWxsZXlcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC95b3NlbWl0ZS5qcGdcIiBcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiTGFrZSBMb3Vpc2V5XCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvbGFrZS1sb3Vpc2UuanBnXCIgXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIkJhbGQgTW91bnRhaW5zXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvYmFsZC1tb3VudGFpbnMuanBnXCIgXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIkxhdGVtYXJcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYXRlbWFyLmpwZ1wiIFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJWYW5vaXNlIE5hdGlvbmFsIFBhcmtcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC92YW5vaXNlLmpwZ1wiIFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJMYWdvIGRpIEJyYWllc1wiLFxyXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2xhZ28uanBnXCIgXHJcbiAgfVxyXG5dO1xyXG5cclxuZXhwb3J0IGNvbnN0IHZhbGlkYXRpb25TZXR0aW5ncyA9IHtcclxuICBpbnB1dFNlbGVjdG9yOiBcIi5tb2RhbF9faW5wdXRcIixcclxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIubW9kYWxfX2J1dHRvblwiLFxyXG4gIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwibW9kYWxfX2J1dHRvbl9kaXNhYmxlZFwiLFxyXG4gIGlucHV0RXJyb3JDbGFzczogXCJtb2RhbF9faW5wdXRfdHlwZV9lcnJvclwiLFxyXG4gIGVycm9yQ2xhc3M6IFwibW9kYWxfX2Vycm9yX3Zpc2libGVcIlxyXG59IiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwb3B1cFNlbGVjdG9yKTtcclxuICB9XHJcblxyXG4gIG9wZW4oKSB7XHJcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnbW9kYWxfb3BlbmVkJyk7XHJcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgdGhpcy5faGFuZGxlRXNjYXBlQ2xvc2UpO1xyXG4gIH1cclxuXHJcbiAgY2xvc2UoKSB7XHJcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSgnbW9kYWxfb3BlbmVkJyk7XHJcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NhcGVDbG9zZSk7XHJcbiAgfVxyXG5cclxuICBfaGFuZGxlRXNjYXBlQ2xvc2UgPSAoZXZlbnQpID0+IHtcclxuICAgIGlmIChldmVudC5rZXkgPT09IFwiRXNjYXBlXCIgfHwgZXZlbnQua2V5ID09PSBcIkVzY1wiKSB7XHJcbiAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5fY2xvc2VCdXR0b24gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsX19jbG9zZScpO1xyXG4gICAgdGhpcy5fY2xvc2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7dGhpcy5jbG9zZSgpO30pO1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGV2ZW50KSA9PiB7XHJcbiAgICAgIGlmIChldmVudC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwibW9kYWxfb3BlbmVkXCIpKSB7XHJcbiAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICB9XHJcbiAgICB9IClcclxuICB9XHJcbn0iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuXHJcbmV4cG9ydCBjbGFzcyBQb3B1cFdpdGhGb3JtIGV4dGVuZHMgUG9wdXB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3RvciwgaGFuZGxlRm9ybVN1Ym1pdCkge1xyXG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9wb3B1cEZvcm0gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsX19mb3JtJylcclxuICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQgPSBoYW5kbGVGb3JtU3VibWl0O1xyXG4gICAgdGhpcy5pbnB1dExpc3QgPSB0aGlzLl9wb3B1cEZvcm0ucXVlcnlTZWxlY3RvckFsbCgnLm1vZGFsX19pbnB1dCcpO1xyXG4gICAgdGhpcy5zdWJtaXRCdXR0b24gPSB0aGlzLl9wb3B1cEZvcm0ucXVlcnlTZWxlY3RvcignLm1vZGFsX19idXR0b24nKTtcclxuICB9XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKVxyXG4gICAgdGhpcy5fcG9wdXBGb3JtLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIChlKSA9PiB7XHJcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgY29uc3QgaW5wdXRWYWx1ZXMgPSB0aGlzLl9nZXRJbnB1dFZhbHVlcygpO1xyXG4gICAgICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQoaW5wdXRWYWx1ZXMpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBfZ2V0SW5wdXRWYWx1ZXMoKSB7XHJcbiAgICBjb25zdCBmb3JtVmFsdWVzID0ge307XHJcbiAgICB0aGlzLmlucHV0TGlzdC5mb3JFYWNoKGlucHV0ID0+IHtcclxuICAgICAgZm9ybVZhbHVlc1tpbnB1dC5uYW1lXSA9IGlucHV0LnZhbHVlLnRyaW0oKTtcclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIGZvcm1WYWx1ZXM7XHJcbiAgfVxyXG4gIHNldElucHV0VmFsdWVzKGRhdGEpIHtcclxuICAgIGNvbnNvbGUubG9nKGRhdGEpO1xyXG4gICAgdGhpcy5pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXQpID0+IHtcclxuICAgICAgLy8gSGVyZSB5b3UgaW5zZXJ0IHRoZSBgdmFsdWVgIGJ5IHRoZSBgbmFtZWAgb2YgdGhlIGlucHV0XHJcbiAgICAgIGlucHV0LnZhbHVlID0gZGF0YVtpbnB1dC5uYW1lXTtcclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgQXBpIGZyb20gXCIuLi9jb21wb25lbnRzL0FQSS5qc1wiO1xyXG5pbXBvcnQgQ2FyZCBmcm9tIFwiLi4vY29tcG9uZW50cy9jYXJkLmpzXCI7XHJcbmltcG9ydCBTZWN0aW9uIGZyb20gXCIuLi9jb21wb25lbnRzL1NlY3Rpb24uanNcIjtcclxuaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qc1wiO1xyXG5pbXBvcnQgVXNlckluZm8gIGZyb20gXCIuLi9jb21wb25lbnRzL1VzZXJJbmZvLmpzXCI7XHJcbmltcG9ydCB7IHZhbGlkYXRpb25TZXR0aW5ncyB9IGZyb20gXCIuLi91dGlscy9jb25zdGFudHMuanNcIjtcclxuaW1wb3J0IHsgUG9wdXBXaXRoRm9ybSB9IGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanNcIjtcclxuaW1wb3J0IHsgUG9wdXBXaXRoSW1hZ2UgfSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qc1wiO1xyXG5pbXBvcnQgeyBQb3B1cFdpdGhDb25maXJtYXRpb24gfSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhDb25maXJtYXRpb24uanNcIjtcclxuaW1wb3J0IFwiLi4vcGFnZXMvaW5kZXguY3NzXCI7XHJcblxyXG4vLyBBUEkgSW5pdGlhbGl6ZWRcclxuY29uc3QgYXBpID0gbmV3IEFwaSh7XHJcbiAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC1hcGkuZW4udHJpcGxldGVuLXNlcnZpY2VzLmNvbS92MVwiLFxyXG4gIGhlYWRlcnM6IHtcclxuICAgIGF1dGhvcml6YXRpb246IFwiOTFiNjAxY2MtZDViMi00MDVkLWEyMWEtNjE0ZTdlOGY1N2U3XCIsXHJcbiAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIlxyXG4gIH1cclxufSk7XHJcblxyXG4vLyBSZW5kZXIgaW5pdGlhbCBjYXJkc1xyXG5jb25zdCBzZWN0aW9uID0gbmV3IFNlY3Rpb24oe1xyXG4gIHJlbmRlcmVyOiAoY2FyZERhdGEpID0+IHtcclxuICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gY3JlYXRlQ2FyZChjYXJkRGF0YSk7XHJcbiAgICBzZWN0aW9uLmFkZEl0ZW1zKGNhcmRFbGVtZW50KTtcclxuICAgIH1cclxuICB9LCAnLmdhbGFyeV9fY2FyZHMnKTtcclxuICBcclxuXHJcbmNvbnN0IHVzZXIgPSBuZXcgVXNlckluZm8oXCIjbmFtZVwiLCBcIiNkZXNjcmlwdGlvblwiLCBcIiNhdmF0YXJcIik7XHJcblxyXG4vL0dldCBVc2VyIGluZm9cclxuYXBpLmdldFVzZXJJbmZvKClcclxuLnRoZW4odXNlckRhdGEgPT4ge1xyXG4gIHVzZXIuc2V0VXNlckluZm8oXHJcbiAgICB7bmFtZTogdXNlckRhdGEubmFtZSxcclxuICAgICAgYWJvdXQ6IHVzZXJEYXRhLmFib3V0LFxyXG4gICAgICBhdmF0YXI6IHVzZXJEYXRhLmF2YXRhcn0pO1xyXG59KVxyXG4uY2F0Y2goZXJyID0+IHtcclxuICBjb25zb2xlLmVycm9yKGBFcnJvciBmZXRjaGluZyB1c2VyIGluZm86ICR7ZXJyfWApO1xyXG59KTtcclxuXHJcbmFwaS5nZXRJbml0aWFsQ2FyZHMoKVxyXG4gIC50aGVuKGNhcmRzID0+IHtcclxuICAgIHNlY3Rpb24ucmVuZGVySXRlbXMoY2FyZHMpO1xyXG4gIH0pXHJcbiAgLmNhdGNoKGVyciA9PiB7XHJcbiAgICBjb25zb2xlLmVycm9yKGBFcnJvciBmZXRjdGluZyBjYXJkczogJHtlcnJ9YCk7XHJcbiAgfSlcclxuXHJcblxyXG4vKiBFbGVtZW50cyAqLyBcclxuXHJcbi8vcG9wdXBzXHJcbmNvbnN0IGVkaXRQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKCcjcHJvZmlsZS1lZGl0LW1vZGFsJywgaGFuZGxlUHJvZmlsZVN1Ym1pdCk7XHJcbmNvbnN0IGFkZENhcmRQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKCcjYWRkLWNhcmQtbW9kYWwnLCBoYW5kbGVBZGRDYXJkU3VibWl0KTtcclxuY29uc3QgaW1hZ2VQb3B1cCA9IG5ldyBQb3B1cFdpdGhJbWFnZSgnI2ltYWdlLW1vZGFsJywgaGFuZGxlSW1hZ2VDbGljayk7IFxyXG5jb25zdCBkZWxldGVQb3B1cCA9IG5ldyBQb3B1cFdpdGhDb25maXJtYXRpb24oJyNkZWxldGUtbW9kYWwnKTtcclxuY29uc3QgYXZhdGFyUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybSgnI2F2YXRhci1tb2RhbCcsIGhhbmRsZUF2YXRhclN1Ym1pdCk7XHJcblxyXG4vL2J1dHRvblxyXG5jb25zdCBwcm9maWxlRWRpdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNwcm9maWxlLWVkaXQtYnV0dG9uJyk7XHJcbmNvbnN0IGFkZE5ld0NhcmRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtYWRkLWJ1dHRvblwiKTtcclxuY29uc3QgYXZhdGFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNhdmF0YXItb3ZlcmxheVwiKTtcclxuXHJcbi8vcHJvZmlsZSBuYW1lICYgZGVzY3JpcHRpb24gLyB1c2VyIGluZm8gLyB1c2UgUHJvZmlsZSBpbWdcclxuY29uc3QgdXNlck5hbWVJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjbmFtZS1pbnB1dFwiKTtcclxuY29uc3QgdXNlckpvYklucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNkZXNjcmlwdGlvbi1pbnB1dFwiKTtcclxuXHJcblxyXG5cclxuLy9mb3Jtc1xyXG5jb25zdCBwcm9maWxlRWRpdEZvcm1FbGVtZW50ID0gZG9jdW1lbnQuZm9ybXNbXCJwcm9maWxlLWVkaXQtZm9ybVwiXTtcclxuY29uc3QgcHJvZmlsZUFkZEZvcm1FbGVtZW50ID0gZG9jdW1lbnQuZm9ybXNbXCJhZGQtY2FyZC1mb3JtXCJdO1xyXG5jb25zdCBkZWxldGVGb3JtRWxlbWVudCA9IGRvY3VtZW50LmZvcm1zW1wiZGVsZXRlLWZvcm1cIl07XHJcbmNvbnN0IGF2YXRhckZvcm1FbGVtZW50ID0gZG9jdW1lbnQuZm9ybXNbXCJhdmF0YXItZm9ybVwiXVxyXG5cclxuLy92YWxpZGF0b3JzXHJcbmNvbnN0IGVkaXRGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IodmFsaWRhdGlvblNldHRpbmdzLCBwcm9maWxlRWRpdEZvcm1FbGVtZW50KTtcclxuY29uc3QgYWRkRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKHZhbGlkYXRpb25TZXR0aW5ncywgcHJvZmlsZUFkZEZvcm1FbGVtZW50KTtcclxuY29uc3QgZGVsZXRlRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKHZhbGlkYXRpb25TZXR0aW5ncywgZGVsZXRlRm9ybUVsZW1lbnQpO1xyXG5jb25zdCBhdmF0YXJGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IodmFsaWRhdGlvblNldHRpbmdzLCBhdmF0YXJGb3JtRWxlbWVudCk7XHJcblxyXG4vL0Zvcm0gVmFsaWRhdG9yc1xyXG5lZGl0Rm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XHJcbmFkZEZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG5kZWxldGVGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuYXZhdGFyRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XHJcblxyXG5cclxuXHJcbi8qIEZ1bmN0aW9ucyovXHJcbi8vQ3JlYXRlIENhcmRcclxuZnVuY3Rpb24gY3JlYXRlQ2FyZChpdGVtKSB7XHJcbiAgY29uc3QgY2FyZEVsZW1lbnQgPSBuZXcgQ2FyZChpdGVtLCAnI2NhcmQtdGVtcGxhdGUnLCBoYW5kbGVJbWFnZUNsaWNrLCBoYW5kbGVEZWxldGVTdWJtaXQsIGhhbmRsZUNhcmRMaWtlKTtcclxuICByZXR1cm4gY2FyZEVsZW1lbnQuZ2V0VmlldygpO1xyXG59XHJcbi8qRXZlbnQgSGFuZGxlcnMqL1xyXG4vL2ltYWdlIGNsaWNrXHJcbmZ1bmN0aW9uIGhhbmRsZUltYWdlQ2xpY2soY2FyZERhdGEpIHtcclxuICAgIGltYWdlUG9wdXAub3BlbihjYXJkRGF0YSk7XHJcbn1cclxuXHJcbi8vZWRpdCBwcm9maWxlXHJcbmZ1bmN0aW9uIGhhbmRsZVByb2ZpbGVTdWJtaXQoZGF0YSkge1xyXG4gIHJlbmRlckxvYWRpbmcodHJ1ZSwgZWRpdFBvcHVwKTtcclxuICBhcGkudXBkYXRlVXNlckluZm8oe1xyXG4gICAgbmFtZTogZGF0YS5uYW1lLFxyXG4gICAgYWJvdXQ6IGRhdGEuYWJvdXRcclxuICB9KVxyXG4gICAgLnRoZW4odXBkYXRlZFVzZXJEYXRhID0+IHtcclxuICAgICAgdXNlci5zZXRVc2VySW5mbyh7XHJcbiAgICAgICAgbmFtZTogdXBkYXRlZFVzZXJEYXRhLm5hbWUsIFxyXG4gICAgICAgIGFib3V0OiB1cGRhdGVkVXNlckRhdGEuYWJvdXQgfHwgdXBkYXRlZFVzZXJEYXRhLmRhc2NyaXB0aW9uIHx8IHVwZGF0ZWRVc2VyRGF0YS5iaW9cclxuICAgICAgfSk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKGVyciA9PiBjb25zb2xlLmVycm9yKGBFcnJvciB1cGRhdGluZyBwcm9maWxlOiAke2Vycn1gKSlcclxuICAgIC5maW5hbGx5KCgpID0+e1xyXG4gICAgICByZW5kZXJMb2FkaW5nKGZhbHNlLCBlZGl0UG9wdXApO1xyXG4gICAgICBlZGl0UG9wdXAuY2xvc2UoKTtcclxuICAgIH1cclxuICAgIClcclxuICAgfVxyXG5cclxuLy8gQWRkIGNhcmRcclxuZnVuY3Rpb24gaGFuZGxlQWRkQ2FyZFN1Ym1pdChkYXRhKSB7XHJcbiAgY29uc3QgY2FyZERhdGEgPSB7XHJcbiAgICBuYW1lOiBkYXRhLnRpdGxlLFxyXG4gICAgbGluazogZGF0YS51cmxcclxuICB9O1xyXG4gIHJlbmRlckxvYWRpbmcodHJ1ZSwgYWRkQ2FyZFBvcHVwKTtcclxuICAvLyBDcmVhdGUgdGhlIENhcmQgXHJcbiAgYXBpLmFkZE5ld0NhcmQoY2FyZERhdGEpXHJcbiAgICAudGhlbigobmV3Q2FyZERhdGEpID0+IHtcclxuICAgICAgY29uc3QgY2FyZEVsZW1lbnQgPSBjcmVhdGVDYXJkKG5ld0NhcmREYXRhKTtcclxuICAgICAgc2VjdGlvbi5hZGRJdGVtcyhjYXJkRWxlbWVudCk7ICBcclxuICAgICAgYWRkQ2FyZFBvcHVwLmNsb3NlKCk7ICAgICAgICAgICAgXHJcbiAgICAgIHByb2ZpbGVBZGRGb3JtRWxlbWVudC5yZXNldCgpOyAgXHJcbiAgICAgIGFkZEZvcm1WYWxpZGF0b3IuZGlzYWJsZUJ1dHRvbigpOyAgXHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKGVyciA9PiB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoYEVycm9yIGFkZGluZyBjYXJkOiAke2Vycn1gKTtcclxuICAgIH0pXHJcbiAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgIHJlbmRlckxvYWRpbmcoZmFsc2UsIGFkZENhcmRQb3B1cClcclxuICAgIH1cclxuICAgIClcclxufVxyXG5cclxuXHJcblxyXG4vL2F2YXRhclxyXG5mdW5jdGlvbiBoYW5kbGVBdmF0YXJTdWJtaXQoZGF0YSl7XHJcbiAgcmVuZGVyTG9hZGluZyh0cnVlLCBhdmF0YXJQb3B1cCk7XHJcbiAgYXBpLnVwZGF0ZVVzZXJBdmF0YXIoe1xyXG4gICAgYXZhdGFyOiBkYXRhLnVybFxyXG4gIH0pXHJcbiAgICAudGhlbih1cGRhdGVVc2VyRGF0YSA9PiB7XHJcbiAgICAgIHVzZXIuc2V0VXNlckluZm8oe1xyXG4gICAgICAgIGF2YXRhcjogdXBkYXRlVXNlckRhdGEuYXZhdGFyXHJcbiAgICAgIH0pO1xyXG4gICAgICBcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goZXJyID0+IGNvbnNvbGUuZXJyb3IoYEVycm9yIHVwZGF0aW5nIGF2YXRhcjogJHtlcnJ9YCkpXHJcbiAgICAuZmluYWxseSgoKSA9PntcclxuICAgICAgcmVuZGVyTG9hZGluZyhmYWxzZSwgYXZhdGFyUG9wdXApO1xyXG4gICAgICBhdmF0YXJQb3B1cC5jbG9zZSgpO1xyXG4gICAgICBhdmF0YXJGb3JtRWxlbWVudC5yZXNldCgpO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbi8vZGVsZXRlXHJcbmZ1bmN0aW9uIGhhbmRsZURlbGV0ZVN1Ym1pdChjYXJkKXtcclxuICByZW5kZXJMb2FkaW5nKHRydWUsIGRlbGV0ZVBvcHVwKTtcclxuICBkZWxldGVQb3B1cC5zZXRTdWJtaXRGdW5jdGlvbigoKSA9PiB7XHJcbiAgICBhcGkuZGVsZXRlQ2FyZChjYXJkLl9pZClcclxuICAgIC50aGVuKGNhcmQgPT4geyAgXHJcbiAgICAgIGNvbnNvbGUubG9nKGNhcmQpO1xyXG4gICAgfSlcclxuICAgICAgLmNhdGNoKGVyciA9PiB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcihgRXJyb3IgZGVsZXRpbmcgY2FyZCAke2Vycn1gKTtcclxuICAgICAgfSlcclxuICAgICAgLmZpbmFsbHkoKCk9PntcclxuICAgICAgICByZW5kZXJMb2FkaW5nKGZhbHNlLCBkZWxldGVQb3B1cCk7XHJcbiAgICAgICAgZGVsZXRlUG9wdXAuY2xvc2UoKTtcclxuICAgICAgICBjYXJkLnJlbW92ZUNhcmQoKTtcclxuICAgICAgfSlcclxuICBcclxuICB9KTtcclxuICBkZWxldGVQb3B1cC5vcGVuKCk7XHJcbiAgXHJcbn0gXHJcbiAgICBcclxuICBcclxuXHJcbi8vbGlrZVxyXG5mdW5jdGlvbiBoYW5kbGVDYXJkTGlrZShjYXJkKXtcclxuICBjb25zdCBpc0xpa2VkID0gY2FyZC5pc0xpa2VkKCk7IFxyXG5cclxuICBjb25zdCBsaWtlUHJvbWlzZSA9IGlzTGlrZWRcclxuICAgID8gYXBpLnJlbW92ZUxpa2UoY2FyZC5nZXRJZCgpKSAgXHJcbiAgICA6IGFwaS5hZGRMaWtlKGNhcmQuZ2V0SWQoKSk7IFxyXG5cclxuICBsaWtlUHJvbWlzZVxyXG4gICAgLnRoZW4odXBkYXRlZENhcmREYXRhID0+IHtcclxuICAgICAgY2FyZC51cGRhdGVMaWtlcyh1cGRhdGVkQ2FyZERhdGEuaXNMaWtlZCk7ICBcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goZXJyID0+IGNvbnNvbGUuZXJyb3IoYEVycm9yIHVwZGF0aW5nIGxpa2Ugc3RhdHVzOiAke2Vycn1gKSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIG9wZW5Nb2RhbChwb3B1cCkge1xyXG4gIGNvbnN0IGN1cnJlbnRVc2VyID0gdXNlci5nZXRVc2VySW5mbygpO1xyXG4gIHVzZXJOYW1lSW5wdXQudmFsdWUgPSBjdXJyZW50VXNlci5uYW1lO1xyXG4gIHVzZXJKb2JJbnB1dC52YWx1ZSA9IGN1cnJlbnRVc2VyLmFib3V0O1xyXG4gIHBvcHVwLm9wZW4oKTtcclxufVxyXG5cclxuZnVuY3Rpb24gcmVuZGVyTG9hZGluZyhpc1NhdmluZywgcG9wdXApe1xyXG4gIGlmKGlzU2F2aW5nKXtcclxuICAgIGlmKHBvcHVwID09IGRlbGV0ZVBvcHVwKXtcclxuICAgICAgcmV0dXJuIHBvcHVwLmNvbmZpcm1CdXR0b24udGV4dENvbnRlbnQgPSBcIkRlbGVhdGluZyBDYXJkXCI7XHJcbiAgICB9XHJcbiAgICBpZihwb3B1cCA9PSBhZGRDYXJkUG9wdXApe1xyXG4gICAgICByZXR1cm4gcG9wdXAuc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gXCJDcmVhdGluZyBDYXJkXCI7XHJcbiAgICB9XHJcbiAgICBpZiAocG9wdXAgPT0gZWRpdFBvcHVwIHx8IGF2YXRhclBvcHVwKXtcclxuICAgICAgcmV0dXJuIHBvcHVwLnN1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IFwiU2F2aW5nXCI7XHJcbiAgICB9XHJcbiAgICBcclxuICAgICAgICBcclxuICB9XHJcbiAgZWxzZXtcclxuICAgIGlmKHBvcHVwID09IGRlbGV0ZVBvcHVwKXtcclxuICAgICAgcmV0dXJuIHBvcHVwLmNvbmZpcm1CdXR0b24udGV4dENvbnRlbnQgPSBcIlllc1wiO1xyXG4gICAgfVxyXG4gICAgaWYocG9wdXAgPT0gYWRkQ2FyZFBvcHVwKXtcclxuICAgICAgcmV0dXJuIHBvcHVwLnN1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IFwiQ3JlYXRlXCI7XHJcbiAgICB9XHJcbiAgICBpZihwb3B1cCA9PSBlZGl0UG9wdXAgfHwgYXZhdGFyUG9wdXApIHtcclxuICAgICAgcmV0dXJuIHBvcHVwLnN1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IFwiU2F2ZVwiO1xyXG4gICAgfVxyXG59fVxyXG5cclxuLy8gRXZlbnQgTGlzdGVuZXJzXHJcbmF2YXRhci5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+e29wZW5Nb2RhbChhdmF0YXJQb3B1cCl9KVxyXG5cclxucHJvZmlsZUVkaXRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PntvcGVuTW9kYWwoZWRpdFBvcHVwKX0pO1xyXG5cclxuYWRkTmV3Q2FyZEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuICBhZGRDYXJkUG9wdXAub3BlbigpO1xyXG59KTtcclxuXHJcblxyXG5cclxuZWRpdFBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbmFkZENhcmRQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5pbWFnZVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbmRlbGV0ZVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbmF2YXRhclBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlY3Rpb24ge1xyXG4gIGNvbnN0cnVjdG9yKHtkYXRhLCByZW5kZXJlcn0sIGNvbnRhaW5lclNlbGVjdG9yKSB7XHJcbiAgICB0aGlzLl9kYXRhID0gZGF0YTtcclxuICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXI7XHJcbiAgICB0aGlzLl9jb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNvbnRhaW5lclNlbGVjdG9yKTtcclxuICB9XHJcblxyXG4gIHJlbmRlckl0ZW1zKGRhdGEpIHtcclxuICAgIGRhdGEuZm9yRWFjaChpdGVtID0+IHtcclxuICAgICAgdGhpcy5fcmVuZGVyZXIoaXRlbSk7XHJcbiAgfSk7XHJcbn1cclxuXHJcbiAgYWRkSXRlbXMoZWxlbWVudCkge1xyXG4gICAgdGhpcy5fY29udGFpbmVyLnByZXBlbmQoZWxlbWVudCk7XHJcbiAgfVxyXG5cclxuXHJcbn0iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBVc2VySW5mb3tcclxuICBjb25zdHJ1Y3RvcihuYW1lU2VsY3Rvciwgam9iU2VsZWN0b3IsIGF2YXRhclNlbGVjdG9yKXtcclxuICAgIHRoaXMuX25hbWVFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihuYW1lU2VsY3Rvcik7XHJcbiAgICB0aGlzLl9qb2JFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihqb2JTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9hdmF0YXJFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihhdmF0YXJTZWxlY3RvcilcclxuICAgIFxyXG4gIH1cclxuICBnZXRVc2VySW5mbygpe1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgbmFtZTogdGhpcy5fbmFtZUVsZW1lbnQudGV4dENvbnRlbnQsIFxyXG4gICAgICBhYm91dDogdGhpcy5fam9iRWxlbWVudC50ZXh0Q29udGVudCxcclxuICAgICAgYXZhdGFyOiB0aGlzLl9hdmF0YXJFbGVtZW50LnNyY307ICAgIFxyXG4gIH1cclxuICBzZXRVc2VySW5mbyhkYXRhKXtcclxuICAgIGlmIChkYXRhLm5hbWUpIHRoaXMuX25hbWVFbGVtZW50LnRleHRDb250ZW50ID0gZGF0YS5uYW1lO1xyXG4gICAgaWYoZGF0YS5hYm91dCkgdGhpcy5fam9iRWxlbWVudC50ZXh0Q29udGVudCA9IGRhdGEuYWJvdXQ7XHJcbiAgICBpZihkYXRhLmF2YXRhcikgdGhpcy5fYXZhdGFyRWxlbWVudC5zcmMgPSBkYXRhLmF2YXRhcjtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yLCBkYXRhKSB7XHJcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcclxuICAgIHRoaXMuX3BvcHVwSW1hZ2UgPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsX19pbWFnZScpO1xyXG4gICAgdGhpcy5fcG9wdXBUaXRsZSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfX2NhcmQtdGl0bGUnKTtcclxuICAgIFxyXG4gICAgXHJcblxyXG4gIH1cclxuICBvcGVuKGRhdGEpe1xyXG4gICAvLyBzZXQgdGhlIGltYWdlJ3Mgc3JjIGFuZCBhbHRcclxuICAgIHRoaXMuX3BvcHVwSW1hZ2Uuc3JjID0gZGF0YS5saW5rO1xyXG4gICAgdGhpcy5fcG9wdXBJbWFnZS5hbHQgPSBkYXRhLm5hbWU7XHJcbiAgIC8vIHNldCB0aGUgY2FwdGlvbidzIHRleHRDb250ZW50XHJcbiAgICB0aGlzLl9wb3B1cFRpdGxlLnRleHRDb250ZW50ID0gZGF0YS5uYW1lO1xyXG4gICAgc3VwZXIub3BlbigpO1xyXG4gIH1cclxufSIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5cclxuZXhwb3J0IGNsYXNzIFBvcHVwV2l0aENvbmZpcm1hdGlvbiBleHRlbmRzIFBvcHVwe1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3Ipe1xyXG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XHJcbiAgICB0aGlzLmNvbmZpcm1CdXR0b24gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsX19idXR0b24nKVxyXG4gIH1cclxuXHJcbiAgc2V0U3VibWl0RnVuY3Rpb24oc3VibWl0RnVuY3Rpb24pe1xyXG4gICAgdGhpcy5faGFuZGxlQ29uZmlybSA9IHN1Ym1pdEZ1bmN0aW9uXHJcbiAgfVxyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICB9XHJcbiAgICBcclxuICB9XHJcbiJdLCJuYW1lcyI6WyJBcGkiLCJjb25zdHJ1Y3RvciIsIm9wdGlvbnMiLCJ0aGlzIiwiX2Jhc2VVcmwiLCJiYXNlVXJsIiwiX2hlYWRlcnMiLCJoZWFkZXJzIiwiX2NoZWNrUmVzcG9uc2UiLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwiX3JlcXVlc3QiLCJ1cmwiLCJmZXRjaCIsInRoZW4iLCJnZXRJbml0aWFsQ2FyZHMiLCJtZXRob2QiLCJnZXRVc2VySW5mbyIsInVwZGF0ZVVzZXJJbmZvIiwiZGF0YSIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwidXBkYXRlVXNlckF2YXRhciIsImF2YXRhciIsImFkZE5ld0NhcmQiLCJuYW1lIiwibGluayIsImRlbGV0ZUNhcmQiLCJjYXJkSWQiLCJhZGRMaWtlIiwicmVtb3ZlTGlrZSIsImF1dGhvdXJpemF0aW9uIiwiQ2FyZCIsImNhcmRTZWxlY3RvciIsImhhbmRsZUltYWdlQ2xpY2siLCJoYW5kbGVEZWxldGVTdWJtaXQiLCJoYW5kbGVDYXJkTGlrZSIsIl9pZCIsIl9uYW1lIiwiX2xpbmsiLCJfaXNMaWtlZCIsImlzTGlrZWQiLCJfdXNlcklkIiwib3duZXIiLCJfY2FyZFNlbGVjdG9yIiwiX2hhbmRsZUltYWdlQ2xpY2siLCJfaGFuZGxlRGVsZXRlU3VibWl0IiwiX2hhbmRsZUNhcmRMaWtlIiwiX2VsZW1lbnQiLCJfZ2V0VGVtcGxhdGUiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiX2xpa2VCdXR0b24iLCJhZGRFdmVudExpc3RlbmVyIiwiX2RlbGV0ZUJ1dHRvbiIsIl9jYXJkSW1hZ2VFbGVtZW50IiwidXBkYXRlTGlrZXMiLCJ1cGRhdGVkTGlrZSIsInRvZ2dsZUxpa2VJY29uIiwiY2xhc3NMaXN0IiwidG9nZ2xlIiwiZ2V0SWQiLCJyZW1vdmVDYXJkIiwiX2NhcmRFbGVtZW50IiwicmVtb3ZlIiwiZ2V0VmlldyIsInNldEF0dHJpYnV0ZSIsInRleHRDb250ZW50IiwiRm9ybVZhbGlkYXRvciIsInNldHRpbmdzIiwiZm9ybUVsZW1lbnQiLCJfaW5wdXRTZWxlY3RvciIsImlucHV0U2VsZWN0b3IiLCJfc3VibWl0QnV0dG9uU2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsIl9pbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsIl9pbnB1dEVycm9yQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJfZXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJfZm9ybSIsIl9pbnB1dEVscyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJfc3VibWl0QnV0dG9uIiwiX2hpZGVJbnB1dEVycm9yIiwiaW5wdXRFbCIsImVycm9yTWVzc2FnZUVsIiwiaWQiLCJfc2hvd0lucHV0RXJyb3IiLCJhZGQiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsIl9oYXNJbnZhbGlkSW5wdXQiLCJzb21lIiwidmFsaWRpdHkiLCJ2YWxpZCIsIl90b2dnbGVCdXR0b25TdGF0ZSIsImRpc2FibGVCdXR0b24iLCJfZW5hYmxlQnV0dG9uIiwiZGlzYWJsZWQiLCJfY2hlY2tJbnB1dFZhbGlkaXR5IiwiZm9yRWFjaCIsInNldFRpbWVvdXQiLCJlbmFibGVWYWxpZGF0aW9uIiwiZSIsInByZXZlbnREZWZhdWx0IiwidmFsaWRhdGlvblNldHRpbmdzIiwiUG9wdXAiLCJwb3B1cFNlbGVjdG9yIiwiX3BvcHVwRWxlbWVudCIsIm9wZW4iLCJfaGFuZGxlRXNjYXBlQ2xvc2UiLCJjbG9zZSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJldmVudCIsImtleSIsInNldEV2ZW50TGlzdGVuZXJzIiwiX2Nsb3NlQnV0dG9uIiwidGFyZ2V0IiwiY29udGFpbnMiLCJQb3B1cFdpdGhGb3JtIiwiaGFuZGxlRm9ybVN1Ym1pdCIsInN1cGVyIiwiX3BvcHVwRm9ybSIsIl9oYW5kbGVGb3JtU3VibWl0IiwiaW5wdXRMaXN0Iiwic3VibWl0QnV0dG9uIiwiaW5wdXRWYWx1ZXMiLCJfZ2V0SW5wdXRWYWx1ZXMiLCJmb3JtVmFsdWVzIiwiaW5wdXQiLCJ2YWx1ZSIsInRyaW0iLCJzZXRJbnB1dFZhbHVlcyIsImNvbnNvbGUiLCJsb2ciLCJhcGkiLCJhdXRob3JpemF0aW9uIiwic2VjdGlvbiIsIl9yZWYiLCJjb250YWluZXJTZWxlY3RvciIsInJlbmRlcmVyIiwiX2RhdGEiLCJfcmVuZGVyZXIiLCJfY29udGFpbmVyIiwicmVuZGVySXRlbXMiLCJpdGVtIiwiYWRkSXRlbXMiLCJlbGVtZW50IiwicHJlcGVuZCIsImNhcmREYXRhIiwiY2FyZEVsZW1lbnQiLCJjcmVhdGVDYXJkIiwidXNlciIsIm5hbWVTZWxjdG9yIiwiam9iU2VsZWN0b3IiLCJhdmF0YXJTZWxlY3RvciIsIl9uYW1lRWxlbWVudCIsIl9qb2JFbGVtZW50IiwiX2F2YXRhckVsZW1lbnQiLCJhYm91dCIsInNyYyIsInNldFVzZXJJbmZvIiwidXNlckRhdGEiLCJjYXRjaCIsImVyciIsImVycm9yIiwiY2FyZHMiLCJlZGl0UG9wdXAiLCJyZW5kZXJMb2FkaW5nIiwidXBkYXRlZFVzZXJEYXRhIiwiZGFzY3JpcHRpb24iLCJiaW8iLCJmaW5hbGx5IiwiYWRkQ2FyZFBvcHVwIiwidGl0bGUiLCJuZXdDYXJkRGF0YSIsInByb2ZpbGVBZGRGb3JtRWxlbWVudCIsInJlc2V0IiwiYWRkRm9ybVZhbGlkYXRvciIsImltYWdlUG9wdXAiLCJfcG9wdXBJbWFnZSIsIl9wb3B1cFRpdGxlIiwiYWx0IiwiZGVsZXRlUG9wdXAiLCJjb25maXJtQnV0dG9uIiwic2V0U3VibWl0RnVuY3Rpb24iLCJzdWJtaXRGdW5jdGlvbiIsIl9oYW5kbGVDb25maXJtIiwiYXZhdGFyUG9wdXAiLCJ1cGRhdGVVc2VyRGF0YSIsImF2YXRhckZvcm1FbGVtZW50IiwicHJvZmlsZUVkaXRCdXR0b24iLCJhZGROZXdDYXJkQnV0dG9uIiwidXNlck5hbWVJbnB1dCIsInVzZXJKb2JJbnB1dCIsInByb2ZpbGVFZGl0Rm9ybUVsZW1lbnQiLCJmb3JtcyIsImRlbGV0ZUZvcm1FbGVtZW50IiwiZWRpdEZvcm1WYWxpZGF0b3IiLCJkZWxldGVGb3JtVmFsaWRhdG9yIiwiYXZhdGFyRm9ybVZhbGlkYXRvciIsImNhcmQiLCJ1cGRhdGVkQ2FyZERhdGEiLCJvcGVuTW9kYWwiLCJwb3B1cCIsImN1cnJlbnRVc2VyIiwiaXNTYXZpbmciXSwic291cmNlUm9vdCI6IiJ9